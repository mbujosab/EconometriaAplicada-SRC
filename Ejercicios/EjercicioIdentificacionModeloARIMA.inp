# para que gretl guarde los ficheros en el directorio de la pr√°ctica
string directory = $(pwd) ~ "/EjercicioIdentificacionModeloARIMA" 
set workdir "@directory"

open IdentificaEstosARIMA/f7dcbd-12.gdt

gnuplot x --time-series --with-lines --output="SerieEnNiveles.png"
rmplot  x --output="rango-media.png"

logs x
gnuplot l_x --time-series --with-lines --output="SerieEnLogs.png"
rmplot  l_x --output="rango-media-enLogs.png"

AR1 <- arima 1 0 0 ; l_x

outfile --quiet AR1.txt
  AR1 <- arima 1 0 0 ; l_x
end outfile

adf -1 l_x --c --gls --test-down --perron-qu

outfile --quiet test_ADF.txt
    adf -1 l_x --c --gls --test-down --perron-qu 
end outfile

kpss -1 l_x

outfile --quiet test_KPSS.txt
    kpss -1 l_x 
end outfile

diff l_x
gnuplot d_l_x --time-series --with-lines --output="SerieLogEnDiferencias.png"

ARIMA110 <- arima 1 1 0 ; d_l_x

outfile --quiet ARIMA110.txt
  ARIMA110 <- arima 1 1 0 ; d_l_x
end outfile

adf -1 d_l_x --c --gls --test-down --perron-qu

outfile --quiet test_ADF_en_diff.txt
    adf -1 d_l_x --c --gls --test-down --perron-qu 
end outfile

kpss -1 d_l_x

outfile --quiet test_KPSS_en_diff.txt
    kpss -1 d_l_x 
end outfile

corrgm d_l_x 36 --plot="d_l_x_ACF-PACF.png"

ARIMA010X100 <- arima 0 1 0 ; 1 0 0 ; l_x  --nc

outfile --quiet ARIMA010x100.txt
  ARIMA010X100 <- arima 0 1 0 ; 1 0 0 ; l_x  --nc
end outfile

ARIMA210cte <- arima 2 1 0 ; l_x

outfile --quiet ARIMA210cte.txt
  ARIMA210cte <- arima 2 1 0 ; l_x 
end outfile

ARIMA210 <- arima 2 1 0 ; l_x --nc

outfile --quiet ARIMA210.txt
  ARIMA210 <- arima 2 1 0 ; l_x --nc
end outfile

series residuos = $uhat

gnuplot residuos --time-series --with-lines --output="Residuos.png"
corrgm residuos 15 --plot="residuosACF-PACF.png"

corrgm residuos 15

outfile --quiet ResiduosACF-PACF.txt
   corrgm residuos 15 --quiet
end outfile

modtest --normality

outfile --quiet ContrasteNormalidadResiduos.txt
   modtest --normality
end outfile
