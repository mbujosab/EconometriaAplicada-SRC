<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="es-es" xml:lang="es-es">
<head>
<!-- 2024-09-17 mar 15:49 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Econometría Aplicada. Lección 6</title>
<meta name="author" content="Marcos Bujosa" />
<meta name="generator" content="Org Mode" />
<style type="text/css">
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Econometría Aplicada. Lección 6</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org5672fc8">Carga de algunas librerías de R</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org47e06c0">1. Función de autocovarianzas y función de autocorrelación (ACF)</a></li>
<li><a href="#orgd618823">2. Función de autocorrelación parcial  (PACF)</a></li>
<li><a href="#org3673052">3. Densidad espectral</a></li>
<li><a href="#org9148dd4">4. ACF, PACF y densidad espectral de algunos modelos lineales</a>
<ul>
<li><a href="#org3a596a8">4.1. Procesos lineales</a></li>
<li><a href="#org2c77457">4.2. Proceso de Ruido Blanco</a></li>
<li><a href="#org9d12b80">4.3. Proceso de media móvil MA(\(q\))</a></li>
<li><a href="#orgd3204f2">4.4. Proceso de media móvil MA(\(1\))</a>
<ul>
<li><a href="#orga636399">4.4.1. MA(1) con raíz positiva</a></li>
<li><a href="#orgafa8cfc">4.4.2. MA(1) con raíz negativa</a></li>
</ul>
</li>
<li><a href="#orgb228775">4.5. Proceso de media móvil MA(\(2\))</a>
<ul>
<li><a href="#org27b564a">4.5.1. MA(2) con dos raíces reales, una positiva y la otra negativa</a></li>
<li><a href="#orgbbf8b4c">4.5.2. MA(2) con un par de raíces complejas</a></li>
<li><a href="#org70c335b">4.5.3. MA(2) con dos raíces reales y negativas</a></li>
<li><a href="#org273d35c">4.5.4. MA(2) con dos raíces reales y positivas</a></li>
</ul>
</li>
<li><a href="#org51d6a8b">4.6. Proceso autorregresivo AR(\(p\))</a>
<ul>
<li><a href="#orgd65da4a">4.6.1. Demostración de que la PACF tiene cogrado \(-p\) y grado \(p\)</a></li>
</ul>
</li>
<li><a href="#org665631a">4.7. Proceso autorregresivo AR(\(1\))</a></li>
<li><a href="#org72a9f81">Proceso autorregresivo AR(\(1\))</a>
<ul>
<li><a href="#org176e595">AR(1) con raíz positiva</a></li>
<li><a href="#org36c48e2">AR(1) con raíz negativa</a></li>
</ul>
</li>
<li><a href="#orgb5f3fc6">4.8. Proceso autorregresivo AR(\(2\))</a>
<ul>
<li><a href="#orgc07f1ee">4.8.1. AR(2) con dos raíces reales, una positiva y la otra negativa</a></li>
<li><a href="#org42556d1">4.8.2. AR(2) con un par de raíces complejas</a></li>
<li><a href="#orge97fcc5">4.8.3. AR(2) con dos raíces reales y negativas</a></li>
<li><a href="#org73e50b3">4.8.4. AR(2) con dos raíces reales y positivas</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org9550d7d">5. (Resumen) características de procesos MA(\(q\))</a></li>
<li><a href="#org4fe2ef1">6. (Resumen) características de procesos AR(\(p\))</a></li>
<li><a href="#org30bb2ce">7. Nota final</a></div>
</div>
<div class="abstract" id="orgc41ec1d">
<p>
En esta lección veremos algunas herramientas estadísticas.
 y usaré la librería <code>tfarima</code> de
José Luis Gallego siempre que pueda.
</p>

</div>
<div id="outline-container-org5672fc8" class="outline-4">
<h4 id="org5672fc8">Carga de algunas librerías de R</h4>
<div class="outline-text-4" id="text-org5672fc8">
<p>
Primero cargamos la librería <code>tfarima</code> (Repositorio Cran:
<a href="https://cran.r-project.org/web/packages/tfarima/index.html">https://cran.r-project.org/web/packages/tfarima/index.html</a>;
repositorio GitHub: <a href="https://github.com/gallegoj/tfarima">https://github.com/gallegoj/tfarima</a>)
</p>
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">library</span>(tfarima)      <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">librer&#237;a de Jos&#233; Luis Gallego para Time Series</span>
<span style="color: #D0372D;">library</span>(readr)        <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">para leer ficheros CSV</span>
<span style="color: #D0372D;">library</span>(ggplot2)      <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">para el scatterplot (alternaticamente library(tidyverse))</span>
<span style="color: #D0372D;">library</span>(ggfortify)    <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">para pintar series temporales</span>
<span style="color: #D0372D;">library</span>(jtools)       <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">para representaci&#243;n resultados estimaci&#243;n</span>
<span style="color: #D0372D;">library</span>(zoo)          <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">para generar objetos ts (time series)</span>
</pre>
</div>
<p>
y además fijamos los parámetros por defecto para las figuras en <code>png</code>
del notebook
</p>
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">fijamos el tama&#241;o de las figuras que se generan en el notebook</span>
<span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 4, repr.plot.res = 200)
</pre>
</div>
</div>
</div>
<div id="outline-container-org47e06c0" class="outline-2">
<h2 id="org47e06c0"><span class="section-number-2">1.</span> Función de autocovarianzas y función de autocorrelación (ACF)</h2>
<div class="outline-text-2" id="text-1">
<p>
Ya hemos visto que si un proceso estocásticos es estacionario, la
covarianza entre \(X_t\) y \(X_{t+k}\) no depende de \(t\); tan solo depende
de la distancia temporal \(k\) entre ambas variables y que
</p>

<ul class="org-ul">
<li>La secuencia \(\boldsymbol{\gamma}=(\gamma_k\mid k\in\mathbb{Z})\) se denomina <i>función de
autocovarianzas</i></li>

<li><p>
La secuencia \(\boldsymbol{\rho}=(\rho_k\mid k\in\mathbb{Z})\) donde    
\[\rho_k=\frac{Cov(X_t,X_{t-k})}{\sqrt{Var(X_t)Var(X_{t-k})}}=\frac{\gamma_k}{\gamma_0} \]
</p>
<p>
se denomina <i>función de autocorrelación</i> (ACF).
</p></li>
</ul>

<p>
Veamos otra secuencia que también describe la relación entre distintas
variables del proceso.
</p>
</div>
</div>
<div id="outline-container-orgd618823" class="outline-2">
<h2 id="orgd618823"><span class="section-number-2">2.</span> Función de autocorrelación parcial  (PACF)</h2>
<div class="outline-text-2" id="text-2">
<p>
La <i>correlación parcial</i> entre dos variables \(X_t\) y \(X_{t-k}\) de un
proceso estacionario \(\boldsymbol{X}\) mide su correlación una vez
descontado el efecto de las variables \(X_{t-1},\ldots X_{t-(k-1)}\) que
median entre ambas.
\[X_t,\ \overbrace{X_{t-1},\ldots X_{t-(k-1)},}\ X_{t-k}\]
</p>

<p>
Si denotamos con \(\widehat{X_t}\) y \(\widetilde{X_{t-k}}\) los ajustes de
las respectivas regresiones de \(X_t\) y \(X_{t-k}\) sobre \(X_{t-1},\ldots
X_{t-(k-1)};\;\) la <i>correlación parcial</i> \(\pi_k\) entre \(X_t\) y \(X_{t+k}\) es la
correlación entre los residuos de sendas regresiones:
\[\pi_k=Corr\Big((X_t-\widehat{X_t}),\ (X_{t-k}-\widetilde{X_{t-k}})\Big)\]
</p>

<p>
En un proceso débilmente estacionario las correlaciones parciales solo
dependen de la distancia \(k\), lo que permite definir la siguiente
secuencia.
</p>
<p>
<b>Función de autocorrelación parcial</b> (PACF) de un proceso estacionario
\(\boldsymbol{X}\) es la siguiente secuencia
\(\boldsymbol{\pi}=(\pi_k\mid k\in\mathbb{Z}),\;\) que es simétrica pues
\(\pi_{-k}=\pi_k\): \[\begin{cases} \pi_0 & = \rho_0 ={\color{blue}{1}}\\\\ \pi_1 &=Corr(X_t,\
X_{t-1})=\rho_1=\frac{\gamma_1}{\gamma_0}\\\\ \pi_k
&=Corr\Big((X_t-\widehat{X_t}),\ (X_{t-k}-\widetilde{X_{t-k}})\Big)
\end{cases},\] donde \(\widehat{X_t}\) y \(\widetilde{X_{t-k}}\) son los
ajustes de las respectivas regresiones de \(X_t\) y \(X_{t-k}\) sobre
\(X_{t-1},\ldots X_{t-(k-1)}.\;\) i.e., las proyecciones ortogonales
sobre \(\bar{sp}(1,X_{t-1}:X_{t-(k-1)})\).
</p>
<p>
La magnitud de la correlación parcial \(\;\pi_k\;\) refleja la mejora en
la predicción de \(\widehat{X_t}\) si en lugar de usar una combinación
lineal con solo los \(k-1\) primeros retardos,
\(\widehat{X_t}=\widehat{\alpha_0}+\sum_{j=1}^{k-1}\widehat{\alpha_j}
X_{t-j}\), empleáramos \(k\) retardos (i.e., un retardo más).
</p>
<p>
Hay una correspondencia uno-a-uno entre la función de autocovarianzas
\(\boldsymbol{\gamma}\) y la PACF \(\boldsymbol{\pi}\). 
</p>

<p>
Es decir, es posible reconstruir una de las secuencias a partir de la
otra (por ejemplo resolviendo la ecuaciones de Yule-Walker
recursivamente con el algoritmo Levinson-Durbin; véase
<i>Pourahmadi, M. (2001, Capítulo 7)</i> o <i>Brockwell &amp; Davis (1991,
Capitulo 5)</i>)
</p>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Incluir algoritmo en los apuntes&#xa0;&#xa0;&#xa0;<span class="tag"><span class="_EctrApl">@EctrApl</span></span></b><br />
</div>

<p>
Consecuentemente, la PACF \(\boldsymbol{\pi}\) puede verse como una
reparametrización de la función de autocovarianzas
\(\boldsymbol{\gamma}\).
</p>

<p>
Veamos otra transformación de \(\boldsymbol{\gamma}\) que también
arrojará luz sobre las propiedades de un proceso estocástico.
</p>
</div>
</div>
<div id="outline-container-org3673052" class="outline-2">
<h2 id="org3673052"><span class="section-number-2">3.</span> Densidad espectral</h2>
<div class="outline-text-2" id="text-3">
<p>
Si \(\boldsymbol{X}\) es un proceso estocástico con función de
autocovarianzas \(\boldsymbol{\gamma}\in\ell^1\), es decir, con función
de autocovarianzas absolutamente sumable,
\[\sum_{h\in\mathbb{Z}}|\gamma_h|<\infty,\] entonces definimos la
<i>densidad espectral</i> de \(\boldsymbol{X}\) como \[f(\omega)
\quad=\quad\frac{1}{2\pi}\sum_{h\in\mathbb{Z}}\gamma_h e^{-i h\omega}
\quad=\quad\frac{1}{2\pi}\sum_{h\geq0}\gamma_h \cos(h\omega),\qquad
\omega\in[-\pi,\pi].\]
</p>
<p>
La <i>densidad espectral</i> \(f(\omega)\) satisface las siguientes
propiedades:
</p>
<ol class="org-ol">
<li>\(f(\omega)=f(-\omega)\)</li>
<li>\(f(\omega)\geq0\)</li>
<li>\(\int_{-\pi}^\pi f(\omega)d\omega<\infty\)</li>
</ol>

<p>
Es más, partiendo de la densidad espectral se pueden calcular las
covarianzas \[\gamma_h=\int_{-\pi}^\pi f(\omega)e^{-i
h\omega}d\omega;\quad h\in\mathbb{Z}\]
</p>

<p>
Consecuentemente, para \(h=0\)
\[\sigma^2=\gamma_0=\int_{-\pi}^\pi f(\omega)d\omega.\]
</p>

<p>
Por tanto podemos interpretar la densidad espectral como una
descomposición de la varianza oscilaciones de distintas frecuencias.
</p>

<p>
La ACF, la PACF y la <i>densidad espectral</i> son funciones que dependen
únicamente de los dos primeros momentos de la distribución.
</p>

<p>
Su estimación y posterior análisis son la herramienta fundamental para
elegir un modelo ARMA para una serie temporal <i>``estacionaria''</i>.
</p>

<p>
Para entenderlo debemos ver cómo son estas funciones en algunos
modelos lineales concretos.
</p>
</div>
</div>
<div id="outline-container-org9148dd4" class="outline-2">
<h2 id="org9148dd4"><span class="section-number-2">4.</span> ACF, PACF y densidad espectral de algunos modelos lineales</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org3a596a8" class="outline-3">
<h3 id="org3a596a8"><span class="section-number-3">4.1.</span> Procesos lineales</h3>
<div class="outline-text-3" id="text-4-1">
<p>
Sea el proceso lineal
\(\boldsymbol{X}=\boldsymbol{\psi}*\boldsymbol{U}\), donde
\(\;\boldsymbol{U}\sim WN(0,\sigma^2)\;\) y
\(\;\boldsymbol{\psi}\in\ell^1;\;\) es decir
\[X_t=\sum_{j\in\mathbb{Z}}\psi_j U_{t-j}.\] Puesto que \(E(U_t)=0\)
para todo \(t\in\mathbb{Z}\), entonces
\[E(X_t)=E\left(\sum_{j\in\mathbb{Z}}\psi_j
U_{t-j}\right)=\sum_{j\in\mathbb{Z}}\psi_j E(U_{t-j})=0\] Y como
además, \(E(U_j\cdot U_k)=0\) cuando \(j\ne k\), su función de
autocovarianzas es 
</p>
\begin{eqnarray*}
\gamma_{k,t}= E\big[X_{t+k}\cdot X_{t}\big]=&
E\left[\Big(\sum_{j\in\mathbb{Z}}\psi_j
U_{t+k-j}\Big)\Big(\sum_{j\in\mathbb{Z}}\psi_j U_{t-j}\Big)\right]=
\sigma^2\sum_{j\in\mathbb{Z}}\psi_{j+k}\cdot\psi_{j}\\
=&\sigma^2\sum_{j\in\mathbb{Z}}\psi_{j+k}\cdot R(\psi_{-j}) =
\sigma^2\left(\boldsymbol{\psi}(z)*\boldsymbol{\psi}(z^{-1})\right)_k
\end{eqnarray*}
<p>
que solo depende de \(k\) (el proceso es estacionario como ya sabíamos). Por tanto&#x2026;
</p>
<p>
Si \(\boldsymbol{X}\) es un proceso lineal
\(\boldsymbol{X}=\boldsymbol{\psi}*\boldsymbol{U}\), con
\(\;\boldsymbol{U}\sim WN(0,\sigma^2),\;\) donde
\(\boldsymbol{\psi}\in\ell^1\) es una serie formal (i.e., cogrado \(0\)) y
donde \(\psi_0=1\), es decir, si  \[X_t= \sum_{j=1}^\infty\psi_j
U_{t-j}+U_t;\qquad t\in\mathbb{Z}.\]
</p>

<p>
Entonces
</p>

<ul class="org-ul">
<li><p>
\(\boldsymbol{\gamma} \;=\; \sigma^2 \boldsymbol{\psi}(z)*\boldsymbol{\psi}(z^{-1})\)
</p>

<p>
\(\gamma_k = \sigma^2\sum_{j=0}^\infty \psi_{j+k}\cdot\psi_j.\quad\) Además \(\;\gamma_k\to0\;\) cuando \(\;k\to\infty\)
</p></li>
</ul>
<ul class="org-ul">
<li>ACF: \(\;\boldsymbol{\rho} \;=\; \frac{1}{\gamma_0}\boldsymbol{\gamma}\)</li>
</ul>

<ul class="org-ul">
<li>Densidad espectral: \(\;f(\omega) \;=\; \frac{1}{2\pi}\sum_{h\geq0}\gamma_h \cos(h\omega);\quad \omega\in[-\pi,\pi]\)</li>

<li><p>
PACF: \(\;\boldsymbol{\pi}\in\ell^2,\quad\) i.e., \(\;\pi_k\to0\;\) cuando \(\;k\to\infty\) 
</p>

<p>
(Cuando \(\boldsymbol{\pi}\in\ell^2\) se dice que el proceso es <i>no-determinista</i>)
</p></li>
</ul>
</div>
</div>
<div id="outline-container-org2c77457" class="outline-3">
<h3 id="org2c77457"><span class="section-number-3">4.2.</span> Proceso de Ruido Blanco</h3>
<div class="outline-text-3" id="text-4-2">
<p>
Sea \(\boldsymbol{X}=1*\boldsymbol{U}\),
donde \(\;\boldsymbol{U}\sim WN(0,\sigma^2)\;;\) es decir \(X_t=U_t\) para
\(t\in\mathbb{Z}\). Entonces
</p>

<ul class="org-ul">
<li>\(\boldsymbol{\gamma} \;=\; \sigma^2 (1z^0*1z^{0}) \;=\; \sigma^2z^0 \;=\; (\ldots,0,0,{\color{blue}{\sigma^2}},0,0,\ldots)\)</li>
</ul>

<ul class="org-ul">
<li>\(\boldsymbol{\rho} \;=\; \frac{1}{\gamma_0}\boldsymbol{\gamma} \;=\;
  \frac{1}{\sigma^2}\boldsymbol{\gamma} \;=\; 1 z^0 \;=\;
  (\ldots,0,0,{\color{blue}{1}},0,0,\ldots)\)</li>
</ul>

<ul class="org-ul">
<li>\(f(\omega) \;=\; \frac{1}{2\pi}\sum_{h\geq0}\gamma_h \cos(h\omega) \;=\; \frac{\sigma^2}{2\pi} \cos(0\omega) \;=\; \frac{\sigma^2}{2\pi};\quad \omega\in[-\pi,\pi]\)</li>

<li>\(\boldsymbol{\pi} \;=\; 1 z^0 \;=\; (\ldots,0,0,{\color{blue}{1}},0,0,\ldots)\)</li>
</ul>

<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 2, repr.plot.res = 200)
wn <span style="color: #D0372D;">&lt;-</span> um(ar = <span style="color: #008000;">"(1 - 0B)"</span>)
display(list(wn), lag.max = 20, byrow = <span style="color: #6434A3;">TRUE</span>)
</pre>
</div>


<div id="org8bd620a" class="figure">
<p><img src="./img/lecc06/ACFwhitenoise.png" alt="ACFwhitenoise.png" width="900px" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 5, repr.plot.res = 200)
ide(sim(wn, n = 400), lag.max = 20, graphs = c(<span style="color: #008000;">"plot"</span>, <span style="color: #008000;">"acf"</span>, <span style="color: #008000;">"pacf"</span>, <span style="color: #008000;">"pgram"</span>), main=<span style="color: #008000;">"Ruido blanco"</span>)
</pre>
</div>


<div id="org36d9409" class="figure">
<p><img src="./img/lecc06/SimulWhitenoise.png" alt="SimulWhitenoise.png" width="900px" />
</p>
</div>
</div>
</div>
<div id="outline-container-org9d12b80" class="outline-3">
<h3 id="org9d12b80"><span class="section-number-3">4.3.</span> Proceso de media móvil MA(\(q\))</h3>
<div class="outline-text-3" id="text-4-3">
<p>
Sea \(\boldsymbol{X}=\boldsymbol{\theta}*\boldsymbol{U}\), con
\(\;\boldsymbol{U}\sim WN(0,\sigma^2)\;\) y donde \(\boldsymbol{\theta}\)
es un polinomio de orden \(q>0\), con \(\theta_0=1\) y
con todas sus raíces fuera del círculo unidad
\((\boldsymbol{\theta}^{-\triangleright}\in\ell^1)\), es decir \[X_t=
\sum_{j=1}^q\theta_j U_{t-j}+U_t.\]
</p>

<p>
Entonces \(E(X_t)=0\) y
</p>

<p>
\(\boldsymbol{\gamma} \;=\; \sigma^2 \boldsymbol{\theta}(z)*\boldsymbol{\theta}(z^{-1}) \;=\; \sigma^2 \sum\limits_{j,k=0}^q \theta_{j+k}\theta_{j} z^{j}\;\) (grado \(q\) y cogrado \(-q\))
</p>

<p>
\(\boldsymbol{\rho} \;=\; \frac{1}{\gamma_0}\boldsymbol{\gamma}\)
</p>

<p>
\(f(\omega) \;=\; \frac{\sigma^2}{2\pi}\boldsymbol{\theta}(e^{-i\omega})\cdot\boldsymbol{\theta}(e^{i\omega}) \;=\; \frac{1}{2\pi}\sum\limits_{h=0}^q \gamma_h \cos(h\omega);\quad \omega\in[-\pi,\pi]\quad\) (\(q\) cosenos \(+1\))
</p>

<p>
\(\boldsymbol{\pi}\;\) tiene grado \(\infty\) y cogrado \(-\infty\;\) y su magnitud decae paulatinamente cuando \(\;k\to\infty\)
</p>
</div>
</div>
<div id="outline-container-orgd3204f2" class="outline-3">
<h3 id="orgd3204f2"><span class="section-number-3">4.4.</span> Proceso de media móvil MA(\(1\))</h3>
<div class="outline-text-3" id="text-4-4">
<p>
Sea \(\boldsymbol{X}=(1-\theta z)*\boldsymbol{U}\) con \(|\theta|<1\) y
con \(\;\boldsymbol{U}\sim WN(0,\sigma^2)\;\), es decir \(X_t=U_t-\theta
U_{t-1}\).
</p>

<ul class="org-ul">
<li>\(\boldsymbol{\gamma} \;=\; \sigma^2 (1-\theta z)*(1-\theta z^{-1})
  \;=\; \sigma^2 (\ldots,\ 0\ ,\ -\theta,\ {\color{blue}{(1+\theta^2)}},\ -\theta,\
  0,\ \ldots)\)</li>

<li>\(\boldsymbol{\rho} \;=\; \frac{1}{\gamma_0}\boldsymbol{\gamma} \;=\;
  \frac{1}{\sigma^2(1+\theta^2)}\boldsymbol{\gamma}\)</li>

<li>\(f(\omega) \;=\;
  \frac{\sigma^2}{2\pi}\boldsymbol{\theta}(e^{-i\omega})\cdot\boldsymbol{\theta}(e^{i\omega})
  \;=\;
  \frac{\sigma^2}{2\pi}\Big((1+\theta^2)\;-\;2\theta\cos(\omega)\Big);\quad
  \omega\in[-\pi,\pi]\)</li>

<li>\(\boldsymbol{\pi} \;=\; \sum\limits_{k\in\mathbb{Z}}{  \frac{-\theta^k(1-\theta^2)}{1-\theta^{2(k+1)}} z^k}\)</li>
</ul>
</div>
<div id="outline-container-orga636399" class="outline-4">
<h4 id="orga636399"><span class="section-number-4">4.4.1.</span> MA(1) con raíz positiva</h4>
<div class="outline-text-4" id="text-4-4-1">
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 2, repr.plot.res = 200)
ma1p <span style="color: #D0372D;">&lt;-</span> um(ma = <span style="color: #008000;">"(1 - 0.9B)"</span>)
display(list(ma1p), lag.max = 20, byrow = <span style="color: #6434A3;">TRUE</span>)
</pre>
</div>


<p>
\[\boldsymbol{\theta}(z)=1-0.9z\quad\Rightarrow\quad X_t=
(1-0.9 \mathsf{B})U_t.\]
</p>


<div id="org058376d" class="figure">
<p><img src="./img/lecc06/ACF-MA1p.png" alt="ACF-MA1p.png" width="900px" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-jupyter-R" id="orgb85e5fa">roots(ma1p)
</pre>
</div>

<ol class="org-ol">
<li><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Real</th>
<th scope="col" class="org-right">Imaginary</th>
<th scope="col" class="org-right">Modulus</th>
<th scope="col" class="org-right">Frequency</th>
<th scope="col" class="org-right">Period</th>
<th scope="col" class="org-right">Mult.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1.111111</td>
<td class="org-right">0</td>
<td class="org-right">1.111111</td>
<td class="org-right">0</td>
<td class="org-right">Inf</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table></li>
</ol>



<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 5, repr.plot.res = 200)
ide(sim(ma1p, n = 400), lag.max = 20, graphs = c(<span style="color: #008000;">"plot"</span>, <span style="color: #008000;">"acf"</span>, <span style="color: #008000;">"pacf"</span>, <span style="color: #008000;">"pgram"</span>))
</pre>
</div>


<div id="org74f20c2" class="figure">
<p><img src="./img/lecc06/Sim-MA1p.png" alt="Sim-MA1p.png" width="900px" />
</p>
</div>
</div>
</div>
<div id="outline-container-orgafa8cfc" class="outline-4">
<h4 id="orgafa8cfc"><span class="section-number-4">4.4.2.</span> MA(1) con raíz negativa</h4>
<div class="outline-text-4" id="text-4-4-2">
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 2, repr.plot.res = 200)
ma1n <span style="color: #D0372D;">&lt;-</span> um(ma = <span style="color: #008000;">"(1 + 0.9B)"</span>)
display(list(ma1n), lag.max = 20, byrow = <span style="color: #6434A3;">TRUE</span>)
</pre>
</div>

<p>
\[\boldsymbol{\theta}(z)=1+0.9z\quad\Rightarrow\quad X_t=
(1+0.9 \mathsf{B})U_t.\]
</p>


<div id="org420bc0e" class="figure">
<p><img src="./img/lecc06/ACF-MA1n.png" alt="ACF-MA1n.png" width="900px" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-jupyter-R" id="org41462d4">roots(ma1n)
</pre>
</div>

<ol class="org-ol">
<li><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Real</th>
<th scope="col" class="org-right">Imaginary</th>
<th scope="col" class="org-right">Modulus</th>
<th scope="col" class="org-right">Frequency</th>
<th scope="col" class="org-right">Period</th>
<th scope="col" class="org-right">Mult.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">-1.111111</td>
<td class="org-right">0</td>
<td class="org-right">1.111111</td>
<td class="org-right">0.5</td>
<td class="org-right">2</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table></li>
</ol>

<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 5, repr.plot.res = 200)
ide(sim(ma1n, n = 400), lag.max = 20, graphs = c(<span style="color: #008000;">"plot"</span>, <span style="color: #008000;">"acf"</span>, <span style="color: #008000;">"pacf"</span>, <span style="color: #008000;">"pgram"</span>))
</pre>
</div>


<div id="org17c3f7f" class="figure">
<p><img src="./img/lecc06/Sim-MA1n.png" alt="Sim-MA1n.png" width="900px" />
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-orgb228775" class="outline-3">
<h3 id="orgb228775"><span class="section-number-3">4.5.</span> Proceso de media móvil MA(\(2\))</h3>
<div class="outline-text-3" id="text-4-5">
<p>
Sea \(\boldsymbol{X}=(1-\theta_1 z-\theta_2 z^2)*\boldsymbol{U}\), con
\(\;\boldsymbol{U}\sim WN(0,\sigma^2)\;\) y con
\[\theta_1+\theta_2<1;\qquad \theta_2-\theta_1<1;\qquad |\theta_2|<1;\quad \text{(i.e., invertible)}\]
es decir \(X_t=U_t-\theta_1 U_{t-1}-\theta_2 U_{t-2}\).
</p>

<ul class="org-ul">
<li><p>
\(\boldsymbol{\gamma} \;=\; \sigma^2 (1-\theta_1 z-\theta_2 z^2)*(1-\theta_1 z^{-1}-\theta_2 z^{-2})\)
</p>

<p>
\(\gamma_0={\color{blue}{\sigma^2(1+\theta_1^2+\theta_2^2)}};\qquad\)
\(\gamma_1=\sigma^2\big(-\theta_1(1-\theta_2)\big);\qquad\)
\(\gamma_2=\sigma^2(-\theta_2)\)
</p>

<p>
\(\gamma_3=\gamma_4=\cdots=0\qquad\) (y es simétrica) 
</p></li>

<li>\(\boldsymbol{\rho} \;=\; \frac{1}{\gamma_0}\boldsymbol{\gamma} \;=\; \frac{1}{\sigma^2(1+\theta_1^2+\theta_2^2)}\boldsymbol{\gamma}\)</li>

<li>\(f(\omega) \;=\;  \frac{\sigma^2}{2\pi}\Big((1+\theta_1^2+\theta_2^2)\;-\;2\theta_1(1+\theta_2)\cos(\omega)\;-\;2\theta_2\cos(2\omega)\Big)\)</li>
</ul>

<ul class="org-ul">
<li>\(\boldsymbol{\pi}\) tiene una expresión complicada, pero su magnitud
decae paulatinamente.</li>
</ul>
</div>
<div id="outline-container-org27b564a" class="outline-4">
<h4 id="org27b564a"><span class="section-number-4">4.5.1.</span> MA(2) con dos raíces reales, una positiva y la otra negativa</h4>
<div class="outline-text-4" id="text-4-5-1">
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 2, repr.plot.res = 200)
ma2pn <span style="color: #D0372D;">&lt;-</span> um(ma = <span style="color: #008000;">"(1 + 0.1B - 0.8B^2)"</span>)
display(list(ma2pn), lag.max = 20, byrow = <span style="color: #6434A3;">TRUE</span>)
</pre>
</div>

<p>
\[\boldsymbol{\theta}(z)=1+0.1z-0.8z^2\quad\Rightarrow\quad X_t=
(1+0.1\mathsf{B}-0.8\mathsf{B}^2)U_t.\]
</p>


<div id="org3a52117" class="figure">
<p><img src="./img/lecc06/ACF-MA2pn.png" alt="ACF-MA2pn.png" width="900px" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-jupyter-R" id="org444a099">roots(ma2pn)
</pre>
</div>

<ol class="org-ol">
<li><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Real</th>
<th scope="col" class="org-right">Imaginary</th>
<th scope="col" class="org-right">Modulus</th>
<th scope="col" class="org-right">Frequency</th>
<th scope="col" class="org-right">Period</th>
<th scope="col" class="org-right">Mult.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1.18228</td>
<td class="org-right">7.754818e-26</td>
<td class="org-right">1.18228</td>
<td class="org-right">0.0</td>
<td class="org-right">Inf</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">-1.05728</td>
<td class="org-right">-7.754818e-26</td>
<td class="org-right">1.05728</td>
<td class="org-right">0.5</td>
<td class="org-right">2</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table></li>
</ol>


<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 5, repr.plot.res = 200)
ide(sim(ma2pn, n = 400), lag.max = 20, graphs = c(<span style="color: #008000;">"plot"</span>, <span style="color: #008000;">"acf"</span>, <span style="color: #008000;">"pacf"</span>, <span style="color: #008000;">"pgram"</span>))
</pre>
</div>


<div id="org1abfaca" class="figure">
<p><img src="./img/lecc06/Sim-MA2pn.png" alt="Sim-MA2pn.png" width="900px" />
</p>
</div>
</div>
</div>
<div id="outline-container-orgbbf8b4c" class="outline-4">
<h4 id="orgbbf8b4c"><span class="section-number-4">4.5.2.</span> MA(2) con un par de raíces complejas</h4>
<div class="outline-text-4" id="text-4-5-2">
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 2, repr.plot.res = 200)
ma2np <span style="color: #D0372D;">&lt;-</span> um(ma = <span style="color: #008000;">"(1 - 0.1B + 0.8B^2)"</span>)
display(list(ma2np), lag.max = 20, byrow = <span style="color: #6434A3;">TRUE</span>)
</pre>
</div>

<p>
\[\boldsymbol{\theta}(z)=1-0.1z+0.8z^2\quad\Rightarrow\quad X_t=
(1-0.1\mathsf{B}+0.8\mathsf{B}^2)U_t.\]
</p>


<div id="orgfadf23b" class="figure">
<p><img src="./img/lecc06/ACF-MA2np.png" alt="ACF-MA2np.png" width="900px" />
</p>
</div>


<div class="org-src-container">
<pre class="src src-jupyter-R" id="org407cdc0">roots(ma2np)
</pre>
</div>

<ol class="org-ol">
<li><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Real</th>
<th scope="col" class="org-right">Imaginary</th>
<th scope="col" class="org-right">Modulus</th>
<th scope="col" class="org-right">Frequency</th>
<th scope="col" class="org-right">Period</th>
<th scope="col" class="org-right">Mult.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0.0625</td>
<td class="org-right">1.116286</td>
<td class="org-right">1.118034</td>
<td class="org-right">0.2410983</td>
<td class="org-right">4.147685</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">0.0625</td>
<td class="org-right">-1.116286</td>
<td class="org-right">1.118034</td>
<td class="org-right">0.2410983</td>
<td class="org-right">4.147685</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table></li>
</ol>

<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 5, repr.plot.res = 200)
ide(sim(ma2np, n = 400), lag.max = 20, graphs = c(<span style="color: #008000;">"plot"</span>, <span style="color: #008000;">"acf"</span>, <span style="color: #008000;">"pacf"</span>, <span style="color: #008000;">"pgram"</span>))
</pre>
</div>

<p width="900px">
c<img src="./img/lecc06/Sim-MA2np.png" alt="Sim-MA2np.png" width="900px" />
</p>
</div>
</div>
<div id="outline-container-org70c335b" class="outline-4">
<h4 id="org70c335b"><span class="section-number-4">4.5.3.</span> MA(2) con dos raíces reales y negativas</h4>
<div class="outline-text-4" id="text-4-5-3">
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 2, repr.plot.res = 200)
ma2rojo <span style="color: #D0372D;">&lt;-</span> um(ma = <span style="color: #008000;">"(1 + 1.8B + .9B^2 )"</span>)
display(list(ma2rojo), lag.max = 20, byrow = <span style="color: #6434A3;">TRUE</span>)
</pre>
</div>

<p>
\[\boldsymbol{\theta}(z)=1+1.9z+0.9z^2\quad\Rightarrow\quad X_t=
(1+1.8\mathsf{B}+0.9\mathsf{B}^2)U_t.\]
</p>


<div id="org626e867" class="figure">
<p><img src="./img/lecc06/ACF-MA2rojo.png" alt="ACF-MA2rojo.png" width="900px" />
</p>
</div>


<div class="org-src-container">
<pre class="src src-jupyter-R" id="orgdac9448">roots(ma2rojo)
</pre>
</div>

<ol class="org-ol">
<li><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Real</th>
<th scope="col" class="org-right">Imaginary</th>
<th scope="col" class="org-right">Modulus</th>
<th scope="col" class="org-right">Frequency</th>
<th scope="col" class="org-right">Period</th>
<th scope="col" class="org-right">Mult.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">-1</td>
<td class="org-right">0.3333333</td>
<td class="org-right">1.054093</td>
<td class="org-right">0.4487918</td>
<td class="org-right">2.228205</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">-1</td>
<td class="org-right">-0.3333333</td>
<td class="org-right">1.054093</td>
<td class="org-right">0.4487918</td>
<td class="org-right">2.228205</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table></li>
</ol>


<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 5, repr.plot.res = 200)
ide(sim(ma2rojo, n = 400), lag.max = 20, graphs = c(<span style="color: #008000;">"plot"</span>, <span style="color: #008000;">"acf"</span>, <span style="color: #008000;">"pacf"</span>, <span style="color: #008000;">"pgram"</span>))
</pre>
</div>


<div id="orgff78da6" class="figure">
<p><img src="./img/lecc06/Sim-MA2rojo.png" alt="Sim-MA2rojo.png" width="900px" />
</p>
</div>
</div>
</div>
<div id="outline-container-org273d35c" class="outline-4">
<h4 id="org273d35c"><span class="section-number-4">4.5.4.</span> MA(2) con dos raíces reales y positivas</h4>
<div class="outline-text-4" id="text-4-5-4">
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 2, repr.plot.res = 200)
ma2violeta <span style="color: #D0372D;">&lt;-</span> um(ma = <span style="color: #008000;">"(1 - 1.8B + .9B^2 )"</span>)
display(list(ma2violeta), lag.max = 20, byrow = <span style="color: #6434A3;">TRUE</span>)
</pre>
</div>

<p>
\[\boldsymbol{\theta}(z)=1-1.9z+0.9z^2\quad\Rightarrow\quad X_t=
(1-1.8\mathsf{B}+0.9\mathsf{B}^2)U_t.\]
</p>


<div id="org0a394f2" class="figure">
<p><img src="./img/lecc06/ACF-MA2violeta.png" alt="ACF-MA2violeta.png" width="900px" />
</p>
</div>


<div class="org-src-container">
<pre class="src src-jupyter-R" id="org48f83ba">roots(ma2violeta)
</pre>
</div>

<ol class="org-ol">
<li><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Real</th>
<th scope="col" class="org-right">Imaginary</th>
<th scope="col" class="org-right">Modulus</th>
<th scope="col" class="org-right">Frequency</th>
<th scope="col" class="org-right">Period</th>
<th scope="col" class="org-right">Mult.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">0.3333333</td>
<td class="org-right">1.054093</td>
<td class="org-right">0.05120819</td>
<td class="org-right">19.52813</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">-0.3333333</td>
<td class="org-right">1.054093</td>
<td class="org-right">0.05120819</td>
<td class="org-right">19.52813</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table></li>
</ol>


<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 5, repr.plot.res = 200)
ide(sim(ma2violeta, n = 400), lag.max = 20, graphs = c(<span style="color: #008000;">"plot"</span>, <span style="color: #008000;">"acf"</span>, <span style="color: #008000;">"pacf"</span>, <span style="color: #008000;">"pgram"</span>))
</pre>
</div>


<div id="org6552704" class="figure">
<p><img src="./img/lecc06/Sim-MA2violeta.png" alt="Sim-MA2violeta.png" width="900px" />
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org51d6a8b" class="outline-3">
<h3 id="org51d6a8b"><span class="section-number-3">4.6.</span> Proceso autorregresivo AR(\(p\))</h3>
<div class="outline-text-3" id="text-4-6">
<p>
Sea \(\boldsymbol{\phi}*\boldsymbol{X}=\boldsymbol{U}\), con
\(\;\boldsymbol{U}\sim WN(0,\sigma^2)\;\) y donde \(\boldsymbol{\phi}\) es
un polinomio de grado \(p>0\) con \(\phi_0=1\). Entonces
\[(\boldsymbol{\phi}*\boldsymbol{X})_t=\boldsymbol{\phi}(\mathsf{B})X_t=
(1+\phi_1\mathsf{B}+\phi_2\mathsf{B}^2+\cdots+\phi_p\mathsf{B}^p)X_t=
U_t\] Y por tanto \[X_t= U_t-\sum_{j=1}^p\phi_j X_{t-j}.\]
</p>


<p>
Si todas las raíces del polinomio \(\boldsymbol{\phi}\) (de grado \(p\))
están fuera del círculo unidad, es decir, si <i>el polinomio AR es
``invertible''</i>
\(\;(\boldsymbol{\phi}^{-\triangleright}=\boldsymbol{\phi}^{-1}\in\ell^1)\;\)
entonces \(\boldsymbol{X}\) tiene una representación como proceso lineal
causal MA(\(\infty\)): \[\boldsymbol{\phi}*\boldsymbol{X}=\boldsymbol{U}
\quad\Rightarrow\quad
\boldsymbol{X}=\frac{1}{\boldsymbol{\phi}}*\boldsymbol{U}
\quad\Rightarrow\quad X_t = U_t + \sum_{j=1}^\infty\psi_j U_{t-j};\]
donde \(\;\boldsymbol{\phi}^{-1}=\boldsymbol{\psi}=({\color{blue}1},\
\psi_1,\ \psi_2,\ \psi_3,\ldots)\;\) tiene grado \(\infty\).
</p>
<p>
Por tanto \(E(X_t)=0\) para todo \(t\in\mathbb{Z}\) y
</p>

<p>
\(\boldsymbol{\gamma} \;=\; \sigma^2 \frac{1}{\boldsymbol{\phi}(z)}*\frac{1}{\boldsymbol{\phi}(z^{-1})} \;=\; \sigma^2 \sum\limits_{j,k=0}^\infty \psi_{j+k}\psi_j z^{j}\quad\) (grado \(\infty\) y cogrado \(-\infty\))
</p>

<p>
\(\boldsymbol{\rho} \;=\; \frac{1}{\gamma_0}\boldsymbol{\gamma}\)
</p>

<p>
\(f(\omega) =
  \frac{\sigma^2}{2\pi}\frac{1}{\boldsymbol{\phi}(e^{-i\omega})\cdot\boldsymbol{\phi}(e^{i\omega})}
  \;=\; \frac{1}{2\pi}\sum\limits_{h=0}^\infty \gamma_h
  \cos(h\omega);\quad\) donde \(\omega\in[-\pi,\pi]\).
</p>

<p>
(suma infinita de cosenos)
</p>
<p>
Pero la PACF, \(\;\boldsymbol{\pi},\;\) es una secuencia
con grado \(p\) y cogrado \(-p\) (demo en los apuntes).
</p>
</div>
<div id="outline-container-orgd65da4a" class="outline-4">
<h4 id="orgd65da4a"><span class="section-number-4">4.6.1.</span> Demostración de que la PACF tiene cogrado \(-p\) y grado \(p\)</h4>
<div class="outline-text-4" id="text-4-6-1">
<ul class="org-ul">
<li>Sea \(\boldsymbol{X}\) un proceso causal AR(\(p\)): \(\quad
  X_t\;=\;\sum\limits_{j=1}^p\phi_j X_{t-j}+U_t\)</li>
<li>La proyección de \(X_{k+1}\) sobre el espacio \(\bar{sp}(X_{2}:X_k)\)
generado por \(X_2,\ldots X_k\) (con \(k>p\)) es:
\[\widehat{X_{k+1}}=P_{\bar{sp}(X_{2}:X_k)}(X_{k+1})=\sum_{j=1}^p\phi_j X_{k+1-j}\]</li>
<li>De su representación MA(\(\infty\)): \(\;Y\in\bar{sp}(X_{2}:X_k)
  \;\Rightarrow\; Y\in\bar{sp}(U_j\mid{j\leq k})\), pues
\[X_t\;=\;\sum\limits_{j=0}^{\infty} \psi_j U_{t-j}
  \quad\Rightarrow\quad
  \bar{sp}(X_{2}:X_k)\subset\bar{sp}(U_j\mid{j\leq k}) \; \perp \; U_{k+1}\]</li>
<li>Si \(Y\in\bar{sp}(X_{2}:X_k)\) entonces \(Cov\Big((X_{k+1}-\widehat{X_{k+1}}), Y\Big)=Cov(U_{k+1}, Y)=0\)</li>
<li>Denotemos con \(\widetilde{X_{1}}\) a la proyección
\(P_{\bar{sp}(X_{2}:X_k)}(X_{1})\) de \(X_1\) sobre
\(\bar{sp}(X_{2}:X_k)\)</li>
<li><p>
Ahora es fácil ver que \(\pi_k=0\) para \(k>p\), pues
</p>
\begin{eqnarray*}
 \pi_k 
 = & Corr\Big((X_{k+1}-\widehat{X_{k+1}}),(X_{1}-\widetilde{X_{1}})\Big)\\
 = & Corr\Big(U_{k+1},(X_{1}-\widetilde{X_{1}})\Big) \; = \; 0
\end{eqnarray*}
<p>
ya que \(U_{k+1}\perp(X_{1}-\widetilde{X_{1}}) \in \bar{sp}(U_j\mid{j\leq k})\).
</p></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org665631a" class="outline-3">
<h3 id="org665631a"><span class="section-number-3">4.7.</span> Proceso autorregresivo AR(\(1\))</h3>
<div class="outline-text-3" id="text-4-7">
<p>
Sea \(\;(1-\phi z)*\boldsymbol{X}=\boldsymbol{U},\quad\) con
\(\;|\phi|<1\;\) y con \(\;\;\boldsymbol{U}\sim WN(0,\sigma^2)\;\), es
decir \[X_t=\phi X_{t-1} + U_t.\]
</p>

<p>
Y nótese que 
\[(1-a z)*(1+a z+a^2 z^2+a^3 z^3+\cdots)=1;\] 
por lo que ahora hay que calcular infinitos términos en 
\[\boldsymbol{\gamma} \;=\; \sigma^2 (1-\phi z)^{-1}*(1-\phi z^{-1})^{-1}.\]
</p>
<p>
Hay varias formas de hacer los cálculos. Una es vía los productos convolución;
puesto que 
\[(1-a^2 z)^{-1}=(1+a^2 z+a^4 z^2+a^6 z^3+\cdots)=\sum_{h\in\mathbb{Z}} a^{2|h|} z^h\] 
(para verlo basta sustituir \(a^2\) por \(b\)), tenemos que \((1-a z)^{-1}*(1-a z^{-1})^{-1}\) es:
\[
\begin{array}{rcccccccl}
(\ldots,& 0,& 0,& 0,& {\color{blue}{1}},& a,& a^2,& a^3,& \ldots)\\
*(\ldots,& a^3,& a^2,& a,& {\color{blue}{1}},& 0,& 0,& 0,& \ldots)\\\hline
=(\ldots,& \frac{a^3}{1+a^2},& \frac{a^2}{1+a^2},& \frac{a}{1+a^2},&{\color{blue}{\frac{1}{1+a^2}}},& \frac{a}{1+a^2},& \frac{a^2}{1+a^2},& \frac{a^3}{1+a^2},& \ldots)
\end{array}\]
(donde además hemos sustituido \(z\) por \(1\), pues cada término es una suma).
</p>
<p>
Es decir \((1-a z)^{-1}*(1-a z^{-1})^{-1}=\sum\limits_{k\in\mathbb{Z}}\frac{a^{|k|}}{1-a^2}z^k\); y por tanto
\[\boldsymbol{\gamma} \;=\; \sigma^2 (1-\phi z)^{-1}*(1-\phi
  z^{-1})^{-1} \;=\; \frac{\sigma^2}{1-\phi^2} \sum_{k=-\infty}^\infty
  \phi^{|k|} z^k\]
</p>
<p>
Pero también podemos usar las Ecuaciones de Yule-Walker (Lecc. 5). En
este caso (donde el único parámetro es \(\phi_1=\phi\)), en cuanto a la
ACF tenemos que: \[\rho_k=\phi\rho_{k-1}\qquad k>0\] y como \(\rho_0=1\)
\[\rho_k=\phi^k\qquad k\geq0\] Y en cuanto a la varianza, dado que
\(\rho_1=\phi\)
\[\gamma_0=\frac{\sigma^2}{1-\rho_1\phi}=\frac{\sigma^2}{1-\phi^2}.\]
Por tanto, la función de autocovarianzas es \[\boldsymbol{\gamma}
\;=\; \gamma_0\cdot\boldsymbol{\rho} \;=\; \frac{\sigma^2}{1-\phi^2}
\sum_{k=-\infty}^\infty \phi^{|k|} z^k\]
</p>
</div>
</div>
<div id="outline-container-org72a9f81" class="outline-3">
<h3 id="org72a9f81">Proceso autorregresivo AR(\(1\))</h3>
<div class="outline-text-3" id="text-org72a9f81">
<p>
Así pues,
si \(\;(1-\phi z)*\boldsymbol{X}=\boldsymbol{U},\quad\) con
\(\;|\phi|<1\;\) y con \(\;\;\boldsymbol{U}\sim WN(0,\sigma^2)\;\), es
decir, si \[X_t=\phi X_{t-1} + U_t\]
tenemos que
</p>

<p>
\(\boldsymbol{\gamma} \;=\; \sigma^2 (1-\phi z)^{-1}*(1-\phi
  z^{-1})^{-1} \;=\; \frac{\sigma^2}{1-\phi^2}
  \sum\limits_{k=-\infty}^\infty \phi^{|k|} z^k\qquad\) grado \(\infty\) y cogrado \(-\infty\)
</p>

<p>
\(\boldsymbol{\rho} \;=\; \frac{1}{\gamma_0}\boldsymbol{\gamma} \;=\;
  \frac{1+\phi^2}{\sigma^2}\boldsymbol{\gamma} \;=\;
  \sum\limits_{j=-\infty}^\infty \phi^{|j|} z^j \quad\Rightarrow\quad
  \rho_k=\phi^k\) para \(k\geq0\).
</p>

<p>
\(f(\omega) \;=\; \frac{1}{2\pi}\sum\limits_{h=0}^\infty \gamma_h
  \cos(h\omega)=\frac{\sigma^2}{2\pi}\frac{1}{1+\phi^2-2\phi\cos(\omega)}\;\) (compárese con MA(\(1\))).
</p>


<p>
\(\boldsymbol{\pi} \;=\; (\ldots,\; 0,\; 0,\; \phi,\; {\color{blue}1},\; \phi,\; 0,\; 0,\;\ldots)\qquad\) grado \(1\) y cogrado \(-1\)
</p>
</div>
<div id="outline-container-org176e595" class="outline-4">
<h4 id="org176e595">AR(1) con raíz positiva</h4>
<div class="outline-text-4" id="text-org176e595">
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 2, repr.plot.res = 200)
ar1p <span style="color: #D0372D;">&lt;-</span> um(ar = <span style="color: #008000;">"(1 - 0.9B)"</span>)
display(list(ar1p), lag.max = 20, byrow = <span style="color: #6434A3;">TRUE</span>)
</pre>
</div>

<p>
\[\boldsymbol{\phi}(z)=1-0.9z\quad\Rightarrow\quad X_t=0.9X_{t-1}+U_t.\]
</p>


<div id="org575787c" class="figure">
<p><img src="./img/lecc06/ACF-AR1p.png" alt="ACF-AR1p.png" width="900px" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-jupyter-R" id="orge3e586f">roots(ar1p)
</pre>
</div>

<ol class="org-ol">
<li><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Real</th>
<th scope="col" class="org-right">Imaginary</th>
<th scope="col" class="org-right">Modulus</th>
<th scope="col" class="org-right">Frequency</th>
<th scope="col" class="org-right">Period</th>
<th scope="col" class="org-right">Mult.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1.111111</td>
<td class="org-right">0</td>
<td class="org-right">1.111111</td>
<td class="org-right">0</td>
<td class="org-right">Inf</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table></li>
</ol>


<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 5, repr.plot.res = 200)
ide(sim(ar1p, n = 400), lag.max = 20, graphs = c(<span style="color: #008000;">"plot"</span>, <span style="color: #008000;">"acf"</span>, <span style="color: #008000;">"pacf"</span>, <span style="color: #008000;">"pgram"</span>))
</pre>
</div>


<div id="org294b028" class="figure">
<p><img src="./img/lecc06/Sim-AR1p.png" alt="Sim-AR1p.png" width="900px" />
</p>
</div>
</div>
</div>
<div id="outline-container-org36c48e2" class="outline-4">
<h4 id="org36c48e2">AR(1) con raíz negativa</h4>
<div class="outline-text-4" id="text-org36c48e2">
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 2, repr.plot.res = 200)
ar1n <span style="color: #D0372D;">&lt;-</span> um(ar = <span style="color: #008000;">"(1 + 0.9B)"</span>)
display(list(ar1n), lag.max = 20, byrow = <span style="color: #6434A3;">TRUE</span>)
</pre>
</div>

<p>
\[\boldsymbol{\phi}(z)=1+0.9z\quad\Rightarrow\quad X_t=-0.9X_{t-1}+U_t.\]
</p>


<div id="org09ebb46" class="figure">
<p><img src="./img/lecc06/ACF-AR1n.png" alt="ACF-AR1n.png" width="900px" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-jupyter-R" id="org780c8b5">roots(ar1n)
</pre>
</div>

<ol class="org-ol">
<li><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Real</th>
<th scope="col" class="org-right">Imaginary</th>
<th scope="col" class="org-right">Modulus</th>
<th scope="col" class="org-right">Frequency</th>
<th scope="col" class="org-right">Period</th>
<th scope="col" class="org-right">Mult.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">-1.111111</td>
<td class="org-right">0</td>
<td class="org-right">1.111111</td>
<td class="org-right">0.5</td>
<td class="org-right">2</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table></li>
</ol>

<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 5, repr.plot.res = 200)
ide(sim(ar1n, n = 400), lag.max = 20, graphs = c(<span style="color: #008000;">"plot"</span>, <span style="color: #008000;">"acf"</span>, <span style="color: #008000;">"pacf"</span>, <span style="color: #008000;">"pgram"</span>))
</pre>
</div>


<div id="org00b2cf1" class="figure">
<p><img src="./img/lecc06/Sim-AR1n.png" alt="Sim-AR1n.png" width="900px" />
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-orgb5f3fc6" class="outline-3">
<h3 id="orgb5f3fc6"><span class="section-number-3">4.8.</span> Proceso autorregresivo AR(\(2\))</h3>
<div class="outline-text-3" id="text-4-8">
<p>
Sea \(\quad(1-\phi_1 z-\phi_2 z^2)*\boldsymbol{X}=\boldsymbol{U},\quad\)
con \(\;\boldsymbol{U}\sim WN(0,\sigma^2)\;\) y con
\[\phi_1+\phi_2<1;\qquad \phi_2-\phi_1<1;\qquad |\phi_2|<1;\quad
\text{(i.e., invertible)}\] es decir \[X_t=\phi_1 X_{t-1} + \phi_2
X_{t-2} + U_t.\] Entonces
</p>
<p>
\(\boldsymbol{\gamma}=\sigma^2\left(
  \frac{1}{\boldsymbol{\phi}(z)}*\frac{1}{\boldsymbol{\phi}(z^-1)}\right)\qquad\)(Verifica
  \(\;\gamma_k=\phi_1\gamma_{k-1}+\phi_2\gamma_{k-2}\;\) y decae
  paulatinamente)
</p>
<p>
\(\quad\) <i>(de Ec. Yule-Walker: \(\gamma_0 =
   \frac{\sigma^2}{1-\phi_1\rho_1-\phi_2\rho_2}\) y resolvemos
  \(\boldsymbol{\phi}(\mathsf{B})\gamma_k=0\) recursivamente)</i>
</p>

<p>
\(\boldsymbol{\rho} \;=\; \frac{1}{\gamma_0}\boldsymbol{\gamma}\qquad\qquad\qquad\quad\)
  (Verifica \(\;\rho_k=\phi_1\rho_{k-1}+\phi_2\rho_{k-2}\;\) y decae
  paulatinamente)
</p>
<p>
\(f(\omega) \;=\;  \frac{\sigma^2}{2\pi}\frac{1}{1+\phi_1^2+\phi_2^2-2\phi_1(1+\phi_2)\cos(\omega)-2\phi_2\cos(2\omega)}\)
</p>

<p>
\(\boldsymbol{\pi} \;=\; (\ldots,\; 0,\; \phi_2,\; \frac{\phi_1}{1-\phi_2},\; {\color{blue}1},\; \frac{\phi_1}{1-\phi_2},\; \phi_2,\; 0,\;\ldots)\) 
</p>
</div>
<div id="outline-container-orgc07f1ee" class="outline-4">
<h4 id="orgc07f1ee"><span class="section-number-4">4.8.1.</span> AR(2) con dos raíces reales, una positiva y la otra negativa</h4>
<div class="outline-text-4" id="text-4-8-1">
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 2, repr.plot.res = 200)
ar2pn <span style="color: #D0372D;">&lt;-</span> um(ar = <span style="color: #008000;">"(1 + 0.1B - 0.8B^2)"</span>)
display(list(ar2pn), lag.max = 20, byrow = <span style="color: #6434A3;">TRUE</span>)
</pre>
</div>

<p>
\[\boldsymbol{\theta}(z)=1+0.1z-0.8z^2\quad\Rightarrow\quad X_t=
-0.1X_{t-1}+0.8X_{t-2} + U_t.\]
</p>


<div id="orgef1d01c" class="figure">
<p><img src="./img/lecc06/ACF-AR2pn.png" alt="ACF-AR2pn.png" width="900px" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-jupyter-R" id="org7566c71">roots(ar2pn)
</pre>
</div>

<ol class="org-ol">
<li><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Real</th>
<th scope="col" class="org-right">Imaginary</th>
<th scope="col" class="org-right">Modulus</th>
<th scope="col" class="org-right">Frequency</th>
<th scope="col" class="org-right">Period</th>
<th scope="col" class="org-right">Mult.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1.18228</td>
<td class="org-right">7.754818e-26</td>
<td class="org-right">1.18228</td>
<td class="org-right">0.0</td>
<td class="org-right">Inf</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">-1.05728</td>
<td class="org-right">-7.754818e-26</td>
<td class="org-right">1.05728</td>
<td class="org-right">0.5</td>
<td class="org-right">2</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table></li>
</ol>


<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 5, repr.plot.res = 200)
ide(sim(ar2pn, n = 400), lag.max = 20, graphs = c(<span style="color: #008000;">"plot"</span>, <span style="color: #008000;">"acf"</span>, <span style="color: #008000;">"pacf"</span>, <span style="color: #008000;">"pgram"</span>))
</pre>
</div>


<div id="orgc5dd87e" class="figure">
<p><img src="./img/lecc06/Sim-AR2pn.png" alt="Sim-AR2pn.png" width="900px" />
</p>
</div>
</div>
</div>
<div id="outline-container-org42556d1" class="outline-4">
<h4 id="org42556d1"><span class="section-number-4">4.8.2.</span> AR(2) con un par de raíces complejas</h4>
<div class="outline-text-4" id="text-4-8-2">
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 2, repr.plot.res = 200)
ar2np <span style="color: #D0372D;">&lt;-</span> um(ar = <span style="color: #008000;">"(1 - 0.1B + 0.8B^2)"</span>)
display(list(ar2np), lag.max = 20, byrow = <span style="color: #6434A3;">TRUE</span>)
</pre>
</div>

<p>
\[\boldsymbol{\theta}(z)=1-0.1z+0.8z^2\quad\Rightarrow\quad X_t=
0.1X_{t-1}-0.8X_{t-2} + U_t.\]
</p>


<div id="org9896ee2" class="figure">
<p><img src="./img/lecc06/ACF-AR2np.png" alt="ACF-AR2np.png" width="900px" />
</p>
</div>


<div class="org-src-container">
<pre class="src src-jupyter-R" id="orged8d95c">roots(ar2np)
</pre>
</div>

<ol class="org-ol">
<li><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Real</th>
<th scope="col" class="org-right">Imaginary</th>
<th scope="col" class="org-right">Modulus</th>
<th scope="col" class="org-right">Frequency</th>
<th scope="col" class="org-right">Period</th>
<th scope="col" class="org-right">Mult.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0.0625</td>
<td class="org-right">1.116286</td>
<td class="org-right">1.118034</td>
<td class="org-right">0.2410983</td>
<td class="org-right">4.147685</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">0.0625</td>
<td class="org-right">-1.116286</td>
<td class="org-right">1.118034</td>
<td class="org-right">0.2410983</td>
<td class="org-right">4.147685</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table></li>
</ol>

<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 5, repr.plot.res = 200)
ide(sim(ar2np, n = 400), lag.max = 20, graphs = c(<span style="color: #008000;">"plot"</span>, <span style="color: #008000;">"acf"</span>, <span style="color: #008000;">"pacf"</span>, <span style="color: #008000;">"pgram"</span>))
</pre>
</div>

<p width="900px">
c<img src="./img/lecc06/Sim-AR2np.png" alt="Sim-AR2np.png" width="900px" />
</p>
</div>
</div>
<div id="outline-container-orge97fcc5" class="outline-4">
<h4 id="orge97fcc5"><span class="section-number-4">4.8.3.</span> AR(2) con dos raíces reales y negativas</h4>
<div class="outline-text-4" id="text-4-8-3">
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 2, repr.plot.res = 200)
ar2azul <span style="color: #D0372D;">&lt;-</span> um(ar = <span style="color: #008000;">"(1 + 1.8B + .9B^2 )"</span>)
display(list(ar2azul), lag.max = 20, byrow = <span style="color: #6434A3;">TRUE</span>)
</pre>
</div>

<p>
\[\boldsymbol{\theta}(z)=1+1.8z+0.9z^2\quad\Rightarrow\quad X_t=
-1.8X_{t-1}-0.9X_{t-2} + U_t.\]
</p>


<div id="orgbbd5609" class="figure">
<p><img src="./img/lecc06/ACF-AR2azul.png" alt="ACF-AR2azul.png" width="900px" />
</p>
</div>


<div class="org-src-container">
<pre class="src src-jupyter-R" id="org6ba63b6">roots(ar2azul)
</pre>
</div>

<ol class="org-ol">
<li><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Real</th>
<th scope="col" class="org-right">Imaginary</th>
<th scope="col" class="org-right">Modulus</th>
<th scope="col" class="org-right">Frequency</th>
<th scope="col" class="org-right">Period</th>
<th scope="col" class="org-right">Mult.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">-1</td>
<td class="org-right">0.3333333</td>
<td class="org-right">1.054093</td>
<td class="org-right">0.4487918</td>
<td class="org-right">2.228205</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">-1</td>
<td class="org-right">-0.3333333</td>
<td class="org-right">1.054093</td>
<td class="org-right">0.4487918</td>
<td class="org-right">2.228205</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table></li>
</ol>


<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 5, repr.plot.res = 200)
ide(sim(ar2azul, n = 400), lag.max = 20, graphs = c(<span style="color: #008000;">"plot"</span>, <span style="color: #008000;">"acf"</span>, <span style="color: #008000;">"pacf"</span>, <span style="color: #008000;">"pgram"</span>))
</pre>
</div>


<div id="org8991636" class="figure">
<p><img src="./img/lecc06/Sim-AR2azul.png" alt="Sim-AR2azul.png" width="900px" />
</p>
</div>
</div>
</div>
<div id="outline-container-org73e50b3" class="outline-4">
<h4 id="org73e50b3"><span class="section-number-4">4.8.4.</span> AR(2) con dos raíces reales y positivas</h4>
<div class="outline-text-4" id="text-4-8-4">
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 2, repr.plot.res = 200)
ar2rojo <span style="color: #D0372D;">&lt;-</span> um(ar = <span style="color: #008000;">"(1 - 1.8B + .9B^2 )"</span>)
display(list(ar2rojo), lag.max = 20, byrow = <span style="color: #6434A3;">TRUE</span>)
</pre>
</div>

<p>
\[\boldsymbol{\theta}(z)=1-1.8z+0.9z^2\quad\Rightarrow\quad X_t=
1.8X_{t-1}-0.9X_{t-2} + U_t.\]
</p>


<div id="org8d7179b" class="figure">
<p><img src="./img/lecc06/ACF-AR2rojo.png" alt="ACF-AR2rojo.png" width="900px" />
</p>
</div>


<div class="org-src-container">
<pre class="src src-jupyter-R" id="org4375500">roots(ar2rojo)
</pre>
</div>

<ol class="org-ol">
<li><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Real</th>
<th scope="col" class="org-right">Imaginary</th>
<th scope="col" class="org-right">Modulus</th>
<th scope="col" class="org-right">Frequency</th>
<th scope="col" class="org-right">Period</th>
<th scope="col" class="org-right">Mult.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">0.3333333</td>
<td class="org-right">1.054093</td>
<td class="org-right">0.05120819</td>
<td class="org-right">19.52813</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">-0.3333333</td>
<td class="org-right">1.054093</td>
<td class="org-right">0.05120819</td>
<td class="org-right">19.52813</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table></li>
</ol>


<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 5, repr.plot.res = 200)
ide(sim(ar2rojo, n = 400), lag.max = 20, graphs = c(<span style="color: #008000;">"plot"</span>, <span style="color: #008000;">"acf"</span>, <span style="color: #008000;">"pacf"</span>, <span style="color: #008000;">"pgram"</span>))
</pre>
</div>


<div id="org06bec47" class="figure">
<p><img src="./img/lecc06/Sim-AR2rojo.png" alt="Sim-AR2rojo.png" width="900px" />
</p>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org9550d7d" class="outline-2">
<h2 id="org9550d7d"><span class="section-number-2">5.</span> (Resumen) características de procesos MA(\(q\))</h2>
<div class="outline-text-2" id="text-5">
<p>
<span class="underline">Siempre estacionario.</span>
</p>

<p>
Para ser invertible raíces \(\boldsymbol{\theta}\) fuera del círculo
unidad
\((\boldsymbol{\theta}^{-\triangleright}=\boldsymbol{\theta}^{-1}\in\ell^1)\)
</p>
<p>
<b>Tipos de representación del proceso</b>
</p>

<dl class="org-dl">
<dt>Como suma ponderada finita</dt><dd>(número finito de parámetros)
\[\boldsymbol{X}=\boldsymbol{\theta}*\boldsymbol{U}
  \quad\Rightarrow\quad X_t=\boldsymbol{\theta}(\mathsf{B})U_t\]</dd>
<dt>Como suma ponderada infinita</dt><dd>(<span class="underline">solo existe si es invertible</span>):
\[\frac{1}{\boldsymbol{\theta}}*\boldsymbol{X}=\boldsymbol{U}
  \quad\Rightarrow\quad
  \frac{1}{\boldsymbol{\theta}}(\mathsf{B})X_t=U_t\]</dd>
</dl>
<p>
<b>ACF (\(\boldsymbol{\rho}\)):</b> Grado (\(q\)) y cogrado (\(-q\))
</p>
<p>
<b>PACF (\(\boldsymbol{\pi}\)):</b> Grado (\(\infty\)) y cogrado (\(-\infty\)):
exponenciales y/o sinusoidales amortiguadas.
</p>
<p>
<b>Densidad espectral</b> proporcional al inverso de la densidad espectral
  de \(\;\boldsymbol{\theta}*\boldsymbol{X}=\boldsymbol{U}\)
</p>
</div>
</div>
<div id="outline-container-org4fe2ef1" class="outline-2">
<h2 id="org4fe2ef1"><span class="section-number-2">6.</span> (Resumen) características de procesos AR(\(p\))</h2>
<div class="outline-text-2" id="text-6">
<p>
<span class="underline">Siempre invertible.</span>
</p>

<p>
Para ser estacionario raíces de \(\boldsymbol{\phi}\) fuera del círculo
unidad
\((\boldsymbol{\phi}^{-\triangleright}=\boldsymbol{\phi}^{-1}\in\ell^1)\)
</p>
<p>
<b>Tipos de representación del proceso</b>
</p>

<dl class="org-dl">
<dt>Como suma ponderada finita</dt><dd>(número finito de parámetros)
\[\boldsymbol{\phi}*\boldsymbol{X}=\boldsymbol{U}
  \quad\Rightarrow\quad \boldsymbol{\phi}(\mathsf{B})X_t=U_t\]</dd>
<dt>Como suma ponderada infinita</dt><dd>(<span class="underline">solo si es estacionario</span>)
\[\boldsymbol{X}=\frac{1}{\boldsymbol{\phi}}*\boldsymbol{U}
  \quad\Rightarrow\quad
  X_t=\frac{1}{\boldsymbol{\phi}}(\mathsf{B})U_t\]</dd>
</dl>
<p>
<b>ACF (\(\boldsymbol{\rho}\)):</b> Grado (\(\infty\)) y cogrado (\(-\infty\)): 
exponenciales y/o sinusoidales amortiguadas.
</p>
<p>
<b>PACF (\(\boldsymbol{\pi}\)):</b> Grado (\(p\)) y cogrado (\(-p\))
</p>
<p>
<b>Densidad espectral</b> proporcional al inverso de la densidad espectral
de \(\boldsymbol{X}=\boldsymbol{\phi}*\boldsymbol{U}\)
</p>
</div>
</div>
<div id="outline-container-org30bb2ce" class="outline-2">
<h2 id="org30bb2ce"><span class="section-number-2">7.</span> Nota final</h2>
<div class="outline-text-2" id="text-7">
<p>
Se puede demostrar que
</p>
<ul class="org-ul">
<li>si un proceso tiene una ACF \(\boldsymbol{\rho}\) con cogrado \(-q\) y grado \(q\), es un proceso MA(\(q\))</li>
<li>si un proceso tiene una PACF \(\boldsymbol{\pi}\) con cogrado \(-p\) y grado \(p\), es un proceso AR(\(p\))</li>
</ul>

<p>
Véase <i>Pourahmadi M. (2001).</i>
</p>
<p>
Consecuentemente, que la ACF o la PACF se corten ``bruscamente'' nos
indica que el modelo es AR o MA (además de su grado).
</p>

<p>
Desgraciadamente para los modelos ARMA (qué veremos más adelante)
tanto la ACF como la PACF tienen infinitos términos no nulos, por lo
que su identificación no es tan sencilla.
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Marcos Bujosa</p>
<p class="date">Created: 2024-09-17 mar 15:49</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
