<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="es-es" xml:lang="es-es">
<head>
<!-- 2024-09-03 mar 17:57 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Econometría Aplicada. Lección 6</title>
<meta name="author" content="Marcos Bujosa" />
<meta name="generator" content="Org Mode" />
<style type="text/css">
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Econometría Aplicada. Lección 6</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org44b9b9d">Carga de algunas librerías de R</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org616360b">1. Función de autocovarianzas y función de autocorrelación (ACF)</a></li>
<li><a href="#orgd9578b6">2. Función de autocorrelación parcial  (PACF)</a></li>
<li><a href="#org3673052">3. Densidad espectral</a></li>
<li><a href="#org9148dd4">4. ACF, PACF y densidad espectral de algunos modelos lineales</a>
<ul>
<li><a href="#orgf28bb33">4.1. ACF de procesos lineales</a></li>
<li><a href="#org2c77457">4.2. Proceso de Ruido Blanco</a></li>
<li><a href="#orgdee5083">4.3. Media móvil MA(\(q\))</a></li>
<li><a href="#orgd523d41">4.4. Media móvil MA(\(1\))</a></li>
<li><a href="#org492bcba">4.5. AR(1)</a></li>
</ul>
</li>
<li><a href="#org4ac3b1b">5. La especificación del modelo se escoge según las características de los datos.</a></li>
<li><a href="#org9e2deee">6. Herramientas para desvelar propiedades de una serie temporal</a>
<ul>
<li><a href="#orgfa072c8">6.1. Análisis gráfico</a>
<ul>
<li><a href="#orgb300b25">6.1.1. Gráfico de la serie temporal</a></li>
<li><a href="#org9acbd89">6.1.2. Gráfico rango-media</a></li>
</ul>
</li>
<li><a href="#orge6c5ad9">6.2. Determinación del orden de integración</a>
<ul>
<li><a href="#org90c3d2d">6.2.1. Análisis gráfico</a></li>
<li><a href="#org1f0e895">6.2.2. Contrastes formales sobre el orden de integración</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org6a4434f">7. Otras herramientas estadísticas&#xa0;&#xa0;&#xa0;<span class="tag"><span class="C_moHacerConR">CómoHacerConR</span></span></a>
<ul>
<li><a href="#orgcd25fd1">7.1. Estadísticos descriptivos</a></li>
<li><a href="#org8331c96">7.2. Test de normalidad Jarque-Vera</a></div>
</div>
<div class="abstract" id="org9edce9f">
<p>
En esta lección veremos algunas herramientas estadísticas.
 y usaré la librería <code>tfarima</code> de
José Luis Gallego siempre que pueda.
</p>

</div>
<div id="outline-container-org44b9b9d" class="outline-4">
<h4 id="org44b9b9d">Carga de algunas librerías de R</h4>
<div class="outline-text-4" id="text-org44b9b9d">
<p>
Primero cargamos la librería <code>tfarima</code> (Repositorio Cran:
<a href="https://cran.r-project.org/web/packages/tfarima/index.html">https://cran.r-project.org/web/packages/tfarima/index.html</a>;
repositorio GitHub: <a href="https://github.com/gallegoj/tfarima">https://github.com/gallegoj/tfarima</a>)
</p>
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">library</span>(tfarima)      <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">librer&#237;a de Jos&#233; Luis Gallego para Time Series</span>
<span style="color: #D0372D;">library</span>(readr)        <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">para leer ficheros CSV</span>
<span style="color: #D0372D;">library</span>(ggplot2)      <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">para el scatterplot (alternaticamente library(tidyverse))</span>
<span style="color: #D0372D;">library</span>(ggfortify)    <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">para pintar series temporales</span>
<span style="color: #D0372D;">library</span>(jtools)       <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">para representaci&#243;n resultados estimaci&#243;n</span>
<span style="color: #D0372D;">library</span>(zoo)          <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">para generar objetos ts (time series)</span>
</pre>
</div>
<p>
y además fijamos los parámetros por defecto para las figuras en <code>png</code>
del notebook
</p>
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">fijamos el tama&#241;o de las figuras que se generan en el notebook</span>
<span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 4, repr.plot.res = 200)
</pre>
</div>
</div>
</div>
<div id="outline-container-org616360b" class="outline-2">
<h2 id="org616360b"><span class="section-number-2">1.</span> Función de autocovarianzas y función de autocorrelación (ACF)</h2>
<div class="outline-text-2" id="text-1">
<p>
Ya hemos visto que si un proceso estocásticos es estacionario, la
covarianza entre \(X_t\) y \(X_{t+k}\) no depende de \(t\); tan solo depende
de la distancia temporal \(k\) entre ambas variables y que
</p>

<ul class="org-ul">
<li>La secuencia \(\boldsymbol{\gamma}=(\gamma_k\mid k\in\mathbb{Z})\) se denomina <i>función de
autocovarianzas</i></li>

<li><p>
La secuencia \(\boldsymbol{\rho}=(\rho_k\mid k\in\mathbb{Z})\) donde    
\[\rho_k=\frac{Cov(X_t,X_{t-k})}{\sqrt{Var(X_t)Var(X_{t-k})}}=\frac{\gamma_k}{\gamma_0} \]
</p>
<p>
se denomina <i>función de autocorrelación</i> (ACF).
</p></li>
</ul>

<p>
Veamos otra secuencia que también describe la relación entre distintas
variables del proceso.
</p>
</div>
</div>
<div id="outline-container-orgd9578b6" class="outline-2">
<h2 id="orgd9578b6"><span class="section-number-2">2.</span> Función de autocorrelación parcial  (PACF)</h2>
<div class="outline-text-2" id="text-2">
<p>
La <i>correlación parcial</i> entre dos variables \(X_t\) y \(X_{t-k}\) de un
proceso estacionario \(\boldsymbol{X}\) mide su correlación una vez
descontado el efecto de las variables \(X_{t-1},\ldots X_{t-(k-1)}\) que
median entre ambas.
\[X_t,\ \overbrace{X_{t-1},\ldots X_{t-(k-1)},}\ X_{t-k}\]
</p>

<p>
Si denotamos con \(\widehat{X_t}\) y \(\widehat{X_{t-k}}\) los ajustes de
las respectivas regresiones de \(X_t\) y \(X_{t-k}\) sobre \(X_{t-1},\ldots
X_{t-(k-1)};\;\) la <i>correlación parcial</i> entre \(X_t\) y \(X_{t+k}\) es la
correlación entre los residuos de sendas regresiones:
\[Coor\Big((X_t-\widehat{X_t}),\ (X_{t-k}-\widehat{X_{t-k}})\Big)\]
</p>

<p>
En un proceso débilmente estacionario las correlaciones parciales solo
dependen de la distancia \(k\), lo que permite definir la siguiente
secuencia.
</p>
<p>
<b>Función de autocorrelación parcial</b> (PACF) de un proceso estacionario
\(\boldsymbol{X}\) es la siguiente secuencia
\(\boldsymbol{\pi}=(\pi_k\mid k\in\mathbb{Z}),\;\) que es
simétrica pues
\(\pi_{-k}=\pi_k\):
\[\begin{cases}
\pi_0 &=1\\\\
\pi_1 &=Corr(X_t,\ X_{t-1})=\rho_1=\frac{\gamma_1}{\gamma_0}\\\\
\pi_k &=Corr\Big((X_t-\widehat{X_t}),\ (X_{t-k}-\widehat{X_{t-k}})\Big)
\end{cases},\]
donde \(\widehat{X_t}\) y \(\widehat{X_{t-k}}\) son los ajustes de las
respectivas regresiones de \(X_t\) y \(X_{t-k}\) sobre 
\(X_{t-1},\ldots X_{t-(k-1)}\).
</p>
<p>
La magnitud de la correlación parcial \(\;\pi_k\;\) refleja la mejora en
la predicción de \(\widehat{X_t}\) si en lugar de usar una combinación
lineal con solo los \(k-1\) primeros retardos,
\(\widehat{X_t}=\widehat{\alpha_0}+\sum_{j=1}^{k-1}\widehat{\alpha_j}
X_{t-j}\), empleáramos \(k\) retardos (i.e., un retardo más).
</p>
<p>
Hay una correspondencia uno-a-uno entre la función de autocovarianzas
\(\boldsymbol{\gamma}\) y la PACF \(\boldsymbol{\pi}\). 
</p>

<p>
Es decir, es posible reconstruir una de las secuencias a partir de la
otra (por ejemplo resolviendo la ecuaciones de Yule-Walker
recursivamente con el algoritmo Levinson-Durbin; véase
<i>Pourahmadi, M. (2001, Capítulo 7)</i> o <i>Brockwell &amp; Davis (1991,
Capitulo 5)</i>)
</p>

<p>
\(\pi_1=\phi_{11}=\rho_1\)
</p>

<p>
\(\pi_{k+1}=\phi_{k+1,k+1}=\frac{\rho_{k+1}-\sum_{j=1}^k\phi_{kj}\rho_{k+1-j}}{1-\sum_{j=1}^k\phi_{kj}\rho_j}\); donde \(\phi_{k+1,j}=\phi_{kj}-\phi_{k+1,k+1}\phi_{k,k+1-j}\), \(j=1:k\)
</p>

<p>
Consecuentemente, la PACF \(\boldsymbol{\pi}\) puede verse como una
reparametrización de la función de autocovarianzas
\(\boldsymbol{\gamma}\).
</p>

<p>
Veamos otra transformación de \(\boldsymbol{\gamma}\) que también
arrojará luz sobre las propiedades de un proceso estocástico.
</p>
</div>
</div>
<div id="outline-container-org3673052" class="outline-2">
<h2 id="org3673052"><span class="section-number-2">3.</span> Densidad espectral</h2>
<div class="outline-text-2" id="text-3">
<p>
Para un proceso estocástico \(\boldsymbol{X}\) con función de
autocovarianzas \(\boldsymbol{\gamma}\in\ell^1\), es decir, con función
de autocovarianzas absolutamente sumable,
\[\sum_{h\in\mathbb{Z}}|\gamma_h|<\infty,\] entonces definimos la
<i>densidad espectral</i> de \(\boldsymbol{X}\) como \[f(\omega)
\quad=\quad\frac{1}{2\pi}\sum_{h\in\mathbb{Z}}\gamma_h e^{-i h\omega}
\quad=\quad\frac{1}{2\pi}\sum_{h\geq0}\gamma_h \cos(h\omega),\qquad
\omega\in[-\pi,\pi].\]
</p>
<p>
La <i>densidad espectral</i> \(f(\omega)\) satisface las siguientes
propiedades:
</p>
<ol class="org-ol">
<li>\(f(\omega)=f(-\omega)\)</li>
<li>\(f(\omega)\geq0\)</li>
<li>\(\int_{-\pi}^\pi f(\omega)d\omega<\infty\)</li>
</ol>

<p>
Es más, desde la densidad espectral se pueden calcular las covarianzas
\[\gamma_h=\int_{-\pi}^\pi f(\omega)e^{-i h\omega}d\omega;\quad
h\in\mathbb{Z}\]
</p>

<p>
Consecuentemente, para \(h=0\)
\[\sigma^2=\gamma_0=\int_{-\pi}^\pi f(\omega)d\omega.\]
</p>

<p>
Por tanto podemos interpretar la densidad espectral como una
descomposición de la varianza en distintas frecuencias.
</p>

<p>
La ACF, la PACF y la densidad espectral son funciones que solo
dependen de los dos primeros momentos de la distribución.
</p>

<p>
Su estimación y posterior análisis son la herramienta fundamental para
elegir un modelo ARMA para una serie temporal <i>``estacionaria''</i>.
</p>

<p>
Para entenderlo debemos ver cómo son estas funciones en algunos
modelos lineales concretos.
</p>
</div>
</div>
<div id="outline-container-org9148dd4" class="outline-2">
<h2 id="org9148dd4"><span class="section-number-2">4.</span> ACF, PACF y densidad espectral de algunos modelos lineales</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-orgf28bb33" class="outline-3">
<h3 id="orgf28bb33"><span class="section-number-3">4.1.</span> ACF de procesos lineales</h3>
<div class="outline-text-3" id="text-4-1">
<p>
Sea el proceso lineal
\(\boldsymbol{X}=\boldsymbol{\varphi}*\boldsymbol{U}\), donde
\(\;\boldsymbol{U}\sim WN(0,\sigma^2)\;\) y
\(\;\boldsymbol{\varphi}\in\ell^1;\;\) es decir
\[X_t=\sum_{j\in\mathbb{Z}}\varphi_j U_{t-j}.\] Puesto que \(E(U_t)=0\)
para todo \(t\in\mathbb{Z}\), entonces
\[E(X_t)=E\left(\sum_{j\in\mathbb{Z}}\varphi_j
U_{t-j}\right)=\sum_{j\in\mathbb{Z}}\varphi_j E(U_{t-j})=0\] Y como
además, \(E(U_j\cdot U_k)=0\) cuando \(j\ne k\), su función de
autocovarianzas es 
</p>
\begin{eqnarray*}
\gamma_{k,t}= E\big[X_t\cdot X_{t-k}\big]=&
E\left[\Big(\sum_{j\in\mathbb{Z}}\varphi_j
U_{t-j}\Big)\Big(\sum_{j\in\mathbb{Z}}\varphi_j U_{t-k-j}\Big)\right]=
\sigma^2\sum_{j\in\mathbb{Z}}\varphi_{j+k}\cdot\varphi_{j}\\
=&\sigma^2\sum_{j\in\mathbb{Z}}\varphi_{j+k}\cdot R(\varphi_{-j}) =
\sigma^2\left(\boldsymbol{\varphi}(z)*\boldsymbol{\varphi}(z^{-1})\right)_k
\end{eqnarray*}
<p>
que solo depende de \(k\) (el proceso es estacionario como ya sabíamos).
</p>
</div>
</div>
<div id="outline-container-org2c77457" class="outline-3">
<h3 id="org2c77457"><span class="section-number-3">4.2.</span> Proceso de Ruido Blanco</h3>
<div class="outline-text-3" id="text-4-2">
<p>
Sea \(\boldsymbol{X}=\boldsymbol{1}*\boldsymbol{U}\),
donde \(\;\boldsymbol{U}\sim WN(0,\sigma^2)\;;\) es decir \(X_t=U_t\) para
\(t\in\mathbb{Z}\). Entonces
</p>

<ul class="org-ul">
<li>\(\boldsymbol{\gamma} \;=\; \sigma^2 \boldsymbol{1}(z)*\boldsymbol{1}(z^{-1}) \;=\; \sigma^2\boldsymbol{1} \;=\; (\ldots,0,0,\sigma^2,0,0,\ldots) \;=\; \sigma^2 z^0\)</li>
</ul>

<ul class="org-ul">
<li>\(\boldsymbol{\rho} \;=\; \frac{1}{\gamma_0}\boldsymbol{\gamma} \;=\; \frac{1}{\sigma^2}\boldsymbol{\gamma} \;=\; \boldsymbol{1} \;=\; (\ldots,0,0,1,0,0,\ldots) \;=\; 1 z^0\)</li>
</ul>

<ul class="org-ul">
<li>\(\boldsymbol{\pi} \;=\; \boldsymbol{1} \;=\; (\ldots,0,0,1,0,0,\ldots) \;=\; 1 z^0\)</li>
</ul>

<ul class="org-ul">
<li>\(f(\omega) \;=\; \frac{1}{2\pi}\sum_{h\geq0}\gamma_h \cos(h\omega) \;=\; \frac{\sigma^2}{2\pi} \cos(0\omega) \;=\; \frac{\sigma^2}{2\pi};\quad \omega\in[-\pi,\pi]\)</li>
</ul>

<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 2, repr.plot.res = 200)
wn <span style="color: #D0372D;">&lt;-</span> um(ar = <span style="color: #008000;">"(1 - 0B)"</span>)
display(list(ar0p), lag.max = 20, byrow = <span style="color: #6434A3;">TRUE</span>)
</pre>
</div>


<div id="org7f6b128" class="figure">
<p><img src="./img/lecc06/ACFwhitenoise.png" alt="ACFwhitenoise.png" width="900px" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 5, repr.plot.res = 200)
ide(sim(wn, n = 400), lag.max = 20, graphs = c(<span style="color: #008000;">"plot"</span>, <span style="color: #008000;">"acf"</span>, <span style="color: #008000;">"pacf"</span>, <span style="color: #008000;">"pgram"</span>), main=<span style="color: #008000;">"Ruido blanco"</span>)
</pre>
</div>


<div id="org9300d8e" class="figure">
<p><img src="./img/lecc06/SimulWhitenoise.png" alt="SimulWhitenoise.png" width="900px" />
</p>
</div>
</div>
</div>
<div id="outline-container-orgdee5083" class="outline-3">
<h3 id="orgdee5083"><span class="section-number-3">4.3.</span> Media móvil MA(\(q\))</h3>
<div class="outline-text-3" id="text-4-3">
<p>
Sea
\(\boldsymbol{X}=\boldsymbol{\theta}*\boldsymbol{U}\), con
\(\;\boldsymbol{U}\sim WN(0,\sigma^2)\;\) y donde \(\boldsymbol{\theta}\)
es un polinomio de orden \(q\) con \(\theta_0=1\), es decir \[X_t=
\sum_{j=1}^q\theta_j U_{t-j}+U_t.\]
</p>

<ul class="org-ul">
<li>\(\boldsymbol{\gamma} \;=\; \sigma^2 \boldsymbol{\theta}(z)*\boldsymbol{\theta}(z^{-1}) \;=\; \sigma^2 \sum\limits_{j,k=0}^q \theta_j\theta_k z^{j-k}\)</li>

<li>\(\boldsymbol{\rho} \;=\; \frac{1}{\gamma_0}\boldsymbol{\gamma}\)</li>

<li>\(\boldsymbol{\pi}\) tiene una expresión más complicada, pero su magnitud decae paulatinamente</li>

<li>\(f(\omega) \;=\; \frac{\sigma^2}{2\pi}\boldsymbol{\theta}(e^{-i\omega})*\boldsymbol{\theta}(e^{i\omega}) \;=\; \frac{1}{2\pi}\sum\limits_{h=0}^q \gamma_h \cos(h\omega);\quad \omega\in[-\pi,\pi]\)</li>
</ul>
</div>
</div>
<div id="outline-container-orgd523d41" class="outline-3">
<h3 id="orgd523d41"><span class="section-number-3">4.4.</span> Media móvil MA(\(1\))</h3>
<div class="outline-text-3" id="text-4-4">
<p>
Sea \(\boldsymbol{X}=(1+\theta z)*\boldsymbol{U}\), con
\(\;\boldsymbol{U}\sim WN(0,\sigma^2)\;\), es decir \(X_t=U_t+\theta U_{t-1}\).
</p>

<ul class="org-ul">
<li>\(\boldsymbol{\gamma} \;=\; \sigma^2 (1+\theta z)*(1+\theta z^{-1}) \;=\; \sigma^2 (\ldots,\ 0\ ,\ -\theta,\ (1+\theta^2),\ -\theta,\ 0,\ \ldots)\)</li>

<li>\(\boldsymbol{\rho} \;=\; \frac{1}{\gamma_0}\boldsymbol{\gamma} \;=\; \frac{1}{1+\theta^2}\boldsymbol{\gamma}\)</li>

<li>\(\boldsymbol{\pi} \;=\; \sum\limits_{k\in\mathbb{Z}}{ \frac{-\theta^k(1-\theta^2)}{1-\theta^{2(k+1)}} z^k}\)</li>

<li>\(f(\omega) \;=\; \frac{\sigma^2}{2\pi}\boldsymbol{\theta}(e^{-i\omega})*\boldsymbol{\theta}(e^{i\omega}) \;=\; \frac{\sigma^2}{2\pi}\left((1+\theta^2)-\theta\cos(\omega)\right);\quad \omega\in[-\pi,\pi]\)</li>
</ul>


<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 2, repr.plot.res = 200)
ma1p <span style="color: #D0372D;">&lt;-</span> um(ma = <span style="color: #008000;">"(1 + 0.9B)"</span>)
display(list(ma1p), lag.max = 20, byrow = <span style="color: #6434A3;">TRUE</span>)
</pre>
</div>

<p>
\[\boldsymbol{\theta}(z)=1+0.9z\quad\Rightarrow\quad X_t=
(1+0.9 \mathsf{B})U_t.\]
</p>


<div id="org3202d11" class="figure">
<p><img src="./img/lecc06/ACF-MA1p.png" alt="ACF-MA1p.png" width="900px" />
</p>
</div>


<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 5, repr.plot.res = 200)
ide(sim(ma1p, n = 400), lag.max = 20, graphs = c(<span style="color: #008000;">"plot"</span>, <span style="color: #008000;">"acf"</span>, <span style="color: #008000;">"pacf"</span>, <span style="color: #008000;">"pgram"</span>), main=<span style="color: #008000;">"MA(1)"</span>)
</pre>
</div>


<div id="org6dc51c4" class="figure">
<p><img src="./img/lecc06/Sim-MA1p.png" alt="Sim-MA1p.png" width="900px" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 2, repr.plot.res = 200)
ma1n <span style="color: #D0372D;">&lt;-</span> um(ma = <span style="color: #008000;">"(1 - 0.9B)"</span>)
display(list(ma1n), lag.max = 20, byrow = <span style="color: #6434A3;">TRUE</span>)
</pre>
</div>

<p>
\[\boldsymbol{\theta}(z)=1-0.9z\quad\Rightarrow\quad X_t=
(1-0.9 \mathsf{B})U_t.\]
</p>


<div id="org03217b1" class="figure">
<p><img src="./img/lecc06/ACF-MA1n.png" alt="ACF-MA1n.png" width="900px" />
</p>
</div>


<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 5, repr.plot.res = 200)
ide(sim(ma1n, n = 400), lag.max = 20, graphs = c(<span style="color: #008000;">"plot"</span>, <span style="color: #008000;">"acf"</span>, <span style="color: #008000;">"pacf"</span>, <span style="color: #008000;">"pgram"</span>), main=<span style="color: #008000;">"MA(1)"</span>)
</pre>
</div>


<div id="org9186d75" class="figure">
<p><img src="./img/lecc06/Sim-MA1n.png" alt="Sim-MA1n.png" width="900px" />
</p>
</div>
</div>
</div>
<div id="outline-container-org492bcba" class="outline-3">
<h3 id="org492bcba"><span class="section-number-3">4.5.</span> AR(1)</h3>
<div class="outline-text-3" id="text-4-5">
<div class="org-src-container">
<pre class="src src-jupyter-R">ar0p <span style="color: #D0372D;">&lt;-</span> um(ar = <span style="color: #008000;">"(1 - 0B)"</span>)
ar1p <span style="color: #D0372D;">&lt;-</span> um(ar = <span style="color: #008000;">"(1 - 0.9B)"</span>)
ar1n <span style="color: #D0372D;">&lt;-</span> um(ar = <span style="color: #008000;">"(1 + 0.9B)"</span>)
ma1p <span style="color: #D0372D;">&lt;-</span> um(ma = <span style="color: #008000;">"(1 - 0.9B)"</span>)
ma1n <span style="color: #D0372D;">&lt;-</span> um(ma = <span style="color: #008000;">"(1 + 0.9B)"</span>)
ar2c <span style="color: #D0372D;">&lt;-</span> um(ar = <span style="color: #008000;">"(1 - 1.52B + 0.8B^2)"</span>)
<span style="color: #8D8D84;">#</span><span style="color: #8D8D84; font-style: italic;">display(list(ar1p, ar1n, ma1p, ma1n, ar2c), lag.max = 20)</span>
display(list(ar0p), lag.max = 20)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org4ac3b1b" class="outline-2">
<h2 id="org4ac3b1b"><span class="section-number-2">5.</span> La especificación del modelo se escoge según las características de los datos.</h2>
<div class="outline-text-2" id="text-5">
<p>
¿Es la serie 
</p>
<ul class="org-ul">
<li>"<b><i>estacionaria en media</i></b>"
<ul class="org-ul">
<li>(y si lo es, ¿cuál es su media?)</li>
<li>(y si no lo es, ¿cómo cambia o evoluciona su media?)</li>
</ul></li>
<li>"<b><i>estacionaria en varianza</i></b>" (<i>homocedástica</i>)
<ul class="org-ul">
<li>(y si lo es, ¿cuál es su varianza?)</li>
<li>(y si es <i>heterocedástica</i>, ¿cómo cambia o evoluciona su varianza?)?</li>
</ul></li>
</ul>

<p>
¿Están sus valores correlados con su historia pasada (autocorrelados)?
</p>

<p>
¿Están correlados con los valores presentes o pasados de otras series?
</p>
<p>
Veamos algunas herramientas estadísticas para poder desvelar estas
características.
</p>
</div>
</div>
<div id="outline-container-org9e2deee" class="outline-2">
<h2 id="org9e2deee"><span class="section-number-2">6.</span> Herramientas para desvelar propiedades de una serie temporal</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-orgfa072c8" class="outline-3">
<h3 id="orgfa072c8"><span class="section-number-3">6.1.</span> Análisis gráfico</h3>
<div class="outline-text-3" id="text-6-1">
</div>
<div id="outline-container-orgb300b25" class="outline-4">
<h4 id="orgb300b25"><span class="section-number-4">6.1.1.</span> Gráfico de la serie temporal</h4>
<div class="outline-text-4" id="text-6-1-1">
<p>
Representa sus valores en el eje vertical (\(y\)) frente a una escala
temporal en el horizontal (\(x\)). Es útil para detectar visualmente:
</p>
<ul class="org-ul">
<li>tendencias y/o estacionalidad</li>
<li>cambios de variabilidad</li>
<li>valores atípicos (<i>outliers</i>)
<ul class="org-ul">
<li>el 95% aprox. de una muestra de valores generados por una
distribución normal debería estar comprendido entre
\(\mu\pm2\sigma\)</li>
<li><p>
la probabilidad de que una variable normal genere un valor fuera
de las bandas de \(\mu\pm3\sigma\) es \(0.0023\)
</p>

<p>
(<a href="./img/lecc05/IBEX35.png">véase gráfico IBEX 35</a>)
</p></li>
</ul></li>
</ul>

<p>
En es importante escalar y rotular adecuadamente los ejes y asegurar
la comparabilidad entre series y gráficos distintos (si los hubiere).
</p>
</div>
</div>
<div id="outline-container-org9acbd89" class="outline-4">
<h4 id="org9acbd89"><span class="section-number-4">6.1.2.</span> Gráfico rango-media</h4>
<div class="outline-text-4" id="text-6-1-2">
<p>
Cambios de variabilidad de una serie pueden evidenciarse en su gráfico
temporal.
</p>

<p>
Pero también suelen verse bien en un gráfico rango-media, donde se
representa:
</p>
<dl class="org-dl">
<dt>en el eje \(x\)</dt><dd>un indicador del nivel de la serie calculado para
distintas submuestras no solapadas (normalmente la media).</dd>
<dt>en el eje \(y\)</dt><dd>un indicador de la dispersión de la serie
calculado para las mismas submuestras (normalmente el rango.)</dd>
</dl>

<p>
Veamos el gráfico de la serie de pasajeros de líneas aéreas junto a su
gráfico de rango media:
</p>

<div class="org-src-container">
<pre class="src src-jupyter-R">Z <span style="color: #D0372D;">&lt;-</span> AirPassengers
ide(Z, graphs = c(<span style="color: #008000;">"plot"</span>, <span style="color: #008000;">"rm"</span>), main=<span style="color: #008000;">"Pasajeros de l&#237;neas (a&#233;reas en miles) y gr&#225;fico rango-media"</span>)
</pre>
</div>


<div id="org720ae9c" class="figure">
<p><img src="./img/lecc06/rango-mediaAirPass.png" alt="rango-mediaAirPass.png" width="900px" />
</p>
</div>

<p>
El gráfico de rango media a veces se acompaña de una regresión de la
dispersión sobre los niveles para medir la relación nivel-dispersión.
</p>
</div>
</div>
</div>
<div id="outline-container-orge6c5ad9" class="outline-3">
<h3 id="orge6c5ad9"><span class="section-number-3">6.2.</span> Determinación del orden de integración</h3>
<div class="outline-text-3" id="text-6-2">
<p>
Decidir adecuadamente el orden de integración es crucial en el
análisis de series temporales.
</p>

<p>
Las herramientas utilizadas para tomar la decisión son 
</p>
<ul class="org-ul">
<li>el análisis gráfico</li>
<li>los contrastes formales</li>
</ul>
</div>
<div id="outline-container-org90c3d2d" class="outline-4">
<h4 id="org90c3d2d"><span class="section-number-4">6.2.1.</span> Análisis gráfico</h4>
<div class="outline-text-4" id="text-6-2-1">
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 8, repr.plot.res = 200)
ide(PoblacionAustralia_ts,
    graphs = c(<span style="color: #008000;">"plot"</span>),
    transf = list(list(bc = F), list(bc = F, d = 1), list(bc = F, d = 2)),
    main=<span style="color: #008000;">"Poblaci&#243;n australiana, primera diferencia y segunda diferencia"</span> )
</pre>
</div>


<div id="orgaaa7376" class="figure">
<p><img src="./img/lecc06/diferenciasPoblacion.png" alt="diferenciasPoblacion.png" width="900px" />
</p>
</div>



<p>
La serie de población \(\boldsymbol{y}\) tiene una clara tendencia
creciente (primer gráfico), que desaparece al tomar una diferencia
ordinaria, \[\nabla\boldsymbol{y}=(1-\mathsf{B})*\boldsymbol{y}\]
(segundo gráfico). Bastar con tomar una primera diferencia de la serie
de población para obtener una nueva serie que se asemeja a la
realización de un proceso estacionario.
</p>

<p>
No obstante, ¿qué pasa si tomamos una segunda diferencia ordinaria?
\[\nabla\nabla\boldsymbol{y}=\nabla^2\boldsymbol{y}=(1-\mathsf{B})^2*\boldsymbol{y}\]
(segundo gráfico). Pues que la serie obtenida también es estacionaria,
pero ojo, es un grave error tomar más diferencias de las necesarias al
modelizar los datos. Se debe tomar el mínimo número de
transformaciones que arrojen una serie ``estacionaria'' (recuerde que
decir que una serie temporal es <i>estacionaria</i> es un abuso del
lenguaje).
</p>

<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height =  10, repr.plot.res = 200)
ide(Z,
    graphs = c(<span style="color: #008000;">"plot"</span>),
    transf = list(list(bc=T), list(bc=T, d=1), list(bc=T, D=1), list(bc=T, D=1, d=1)),
    main = <span style="color: #008000;">"Log pasajeros a&#233;reos, diferencia ordinaria, diferencia estacional y composici&#243;n de ambas diferencias"</span> )
</pre>
</div>


<div id="org6c846e1" class="figure">
<p><img src="./img/lecc06/diferenciasPasajeros.png" alt="diferenciasPasajeros.png" width="900px" />
</p>
</div>

<p>
Como ya vimos, la serie pasajeros en logaritmos tiene tendencia y
estacionalidad muy evidentes. No basta con tomar solo una diferencia
ordinaria \[\nabla\boldsymbol{y}=(1-\mathsf{B})*\boldsymbol{y};\] pues
el resultado muestra una pauta estacional. Ni tampoco basta con tomar
solo una diferencia estacional
\[\nabla_{12}(\boldsymbol{y})=(1-\mathsf{B^{12}})*\boldsymbol{y};\] pues
resulta una serie que ``deambula'', i.e., que no es <i>``estacionaria''</i>
en media.
</p>

<p>
Tomar una diferencia ordinaria y otra estacional
\[\nabla\nabla_{12}(\boldsymbol{y})=(1-\mathsf{B})*(1-\mathsf{B^{12}})*\boldsymbol{y}\]
arroja una serie que sí parece ser <i>``estacionaria''</i>.
</p>


<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height =  8, repr.plot.res = 200)
TemperaturaRetiro_ts=ts(read.csv(<span style="color: #008000;">"datos/Retiro.txt"</span>),start=c(1985, 1), end=c(2015,9), frequency=12)
ide(TemperaturaRetiro_ts,
    graphs = c(<span style="color: #008000;">"plot"</span>),
    transf = list(list(), list(D = 1)),
    main=<span style="color: #008000;">"Temperatura media en el Retiro y diferencia estacional"</span> )
</pre>
</div>


<div id="org0411cf0" class="figure">
<p><img src="./img/lecc06/diferenciasTemperaturasRetiro.png" alt="diferenciasTemperaturasRetiro.png" width="900px" />
</p>
</div>


<p>
En el caso de la serie de temperaturas en el Parque del Retiro, parece
que es suficiente con tomar solo una diferencia estacional.
</p>
</div>
</div>
<div id="outline-container-org1f0e895" class="outline-4">
<h4 id="org1f0e895"><span class="section-number-4">6.2.2.</span> Contrastes formales sobre el orden de integración</h4>
<div class="outline-text-4" id="text-6-2-2">
</div>
<ol class="org-ol">
<li><a id="org350436e"></a>Test de Dickey-Fuller (DF)<br />
<div class="outline-text-5" id="text-6-2-2-1">
<dl class="org-dl">
<dt>\(H_0\)</dt><dd>la serie es \(I(1)\)</dd>
<dt>\(H_1\)</dt><dd>la serie es \(I(0)\).</dd>
</dl>

<p>
Consideremos el modelo \[y_{t}=\rho y_{t-1}+u_{t},\] donde \(y_{t}\) es
la variable de interés, \(\rho\) es un coeficiente, y \(u_{t}\) es un
proceso de ruido blanco. Una raíz unitaria estará presente si \(\rho
=1\). En tal caso el modelo será no-estacionario.
</p>

<p>
El modelo de regresión se puede escribir como
</p>

<p>
\[\nabla y_{t}=(\rho -1)y_{t-1}+u_{t}=\delta y_{t-1}+u_{t}\]
</p>
</div>
</li>
<li><a id="org218b056"></a>Test de Dickey-Fuller aumentado (ADF)<br /></li>
</ol>
</div>
</div>
</div>
<div id="outline-container-org6a4434f" class="outline-2">
<h2 id="org6a4434f"><span class="section-number-2">7.</span> Otras herramientas estadísticas&#xa0;&#xa0;&#xa0;<span class="tag"><span class="C_moHacerConR">CómoHacerConR</span></span></h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-orgcd25fd1" class="outline-3">
<h3 id="orgcd25fd1"><span class="section-number-3">7.1.</span> Estadísticos descriptivos</h3>
<div class="outline-text-3" id="text-7-1">
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">library</span>(pastecs)      <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">resumen estad&#237;sticos descriptivos</span>
<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">https://cran.r-project.org/web/packages/pastecs/index.html (stat.desc)</span>
<span style="color: #D0372D;">library</span>(knitr)        <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">presentaci&#243;n de tabla resumen</span>
<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">https://cran.r-project.org/web/packages/knitr/index.html (kable)</span>
<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">https://bookdown.org/yihui/rmarkdown-cookbook/kable.html</span>

<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">estad&#237;sticos principales y test de normalidad</span>
kable(stat.desc(Z, basic=<span style="color: #6434A3;">FALSE</span>, norm=<span style="color: #6434A3;">TRUE</span>), <span style="color: #008000;">'rst'</span>)
</pre>
</div>

<pre class="example" id="org282e2de">


============  =============
\                         x
============  =============
median          265.5000000
mean            280.2986111
SE.mean           9.9971931
CI.mean.0.95     19.7613736
var           14391.9172009
std.dev         119.9663169
coef.var          0.4279947
skewness          0.5710676
skew.2SE          1.4132515
kurtosis         -0.4298441
kurt.2SE         -0.5353818
normtest.W        0.9519577
normtest.p        0.0000683
============  =============
</pre>
</div>
</div>
<div id="outline-container-org8331c96" class="outline-3">
<h3 id="org8331c96"><span class="section-number-3">7.2.</span> Test de normalidad Jarque-Vera</h3>
<div class="outline-text-3" id="text-7-2">
<p>
<a href="https://en.wikipedia.org/wiki/Jarque%E2%80%93Bera_test">Jarque-Vera test (Wikipedia)</a>
</p>

<p>
Podemos calcularlo con la librería <a href="https://cran.r-project.org/web/packages/moments/index.html">momments</a>:
</p>
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #8D8D84;">#</span><span style="color: #8D8D84; font-style: italic;">install.packages("moments")</span>
<span style="color: #D0372D;">library</span>(moments)
<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Perform the Jarque-Bera test</span>
jb_test <span style="color: #D0372D;">&lt;-</span> jarque.test(as.numeric(Z))
<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Print the test result</span>
print(jb_test)
</pre>
</div>

<pre class="example">

	Jarque-Bera Normality Test

data:  as.numeric(Z)
JB = 8.9225, p-value = 0.01155
alternative hypothesis: greater

</pre>


<p>
Otra librería alternativa para calcularlo: <a href="https://cran.r-project.org/web/packages/tseries/index.html">tseries</a>
</p>
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">library</span>(tseries)
<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Perform the Jarque-Bera test</span>
jb_test <span style="color: #D0372D;">&lt;-</span> jarque.bera.test(Z)
<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Print the test result</span>
print(jb_test)
</pre>
</div>

<pre class="example">

	Jarque Bera Test

data:  Z
X-squared = 8.9225, df = 2, p-value = 0.01155

</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Marcos Bujosa</p>
<p class="date">Created: 2024-09-03 mar 17:57</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
