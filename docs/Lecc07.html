<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="es-es" xml:lang="es-es">
<head>
<!-- 2024-09-28 sáb 17:59 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Econometría Aplicada. Lección 7</title>
<meta name="author" content="Marcos Bujosa" />
<meta name="generator" content="Org Mode" />
<style type="text/css">
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Econometría Aplicada. Lección 7</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orga0af7d0">Carga de algunas librerías de R</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org78dc417">1. ACF, PACF y densidad espectral de algunos modelos lineales (cont.)</a>
<ul>
<li><a href="#org4bf3573">1.1. Proceso autorregresivo ARMA(\(p,q\))</a></li>
<li><a href="#orgaa17825">1.2. Proceso ARMA(\(1,1\))</a>
<ul>
<li><a href="#org4e2d748">1.2.1. ARMA(1,1) \(\phi_1=0.7\) y \(\theta_1=-0.8\)</a></li>
<li><a href="#org4159ad3">1.2.2. ARMA(1,1) \(\phi_1=-0.7\) y \(\theta_1=0.8\)</a></li>
<li><a href="#org6765042">1.2.3. ARMA(1,1) \(\phi_1=0.4\) y \(\theta_1=0.8\)</a></li>
<li><a href="#orgf5ca3fd">1.2.4. ARMA(1,1) \(\phi_1=-0.8\) y \(\theta_1=-0.4\)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgcc0fb02">2. La especificación del modelo se escoge según las características de los datos.</a></li>
<li><a href="#org53f0513">3. Herramientas para desvelar propiedades de una serie temporal</a>
<ul>
<li><a href="#orgd160f15">3.1. Análisis gráfico</a>
<ul>
<li><a href="#orgcd7d67d">3.1.1. Gráfico de la serie temporal</a></li>
<li><a href="#orgc6d17df">3.1.2. Gráfico rango-media</a></li>
</ul>
</li>
<li><a href="#org201a631">3.2. Determinación del orden de integración</a>
<ul>
<li><a href="#org3dcfc2b">3.2.1. Análisis gráfico</a></li>
<li><a href="#orgb6d73d7">3.2.2. Contrastes formales sobre el orden de integración: DF, ADF y KPSS</a></li>
</ul>
</li>
<li><a href="#org1385020">3.3. ACF muestral</a></li>
<li><a href="#orgcbcbec6">3.4. PACF muestral</a></li>
<li><a href="#org690e710">3.5. Otras herramientas estadísticas&#xa0;&#xa0;&#xa0;<span class="tag"><span class="C_moHacerConR">CómoHacerConR</span></span></a>
<ul>
<li><a href="#org8af0868">3.5.1. Estadísticos descriptivos</a></li>
<li><a href="#orgece7246">3.5.2. Contraste de normalidad Jarque-Bera</a></li>
</ul>
</div>
</div>
<div class="abstract" id="orgd5ad300">
<p>
En esta lección veremos la estructura de la ACF, la PACF y la densidad
espectral de procesos ARMA. Después indicaremos algunas herramientas
estadísticas que usaremos para tratar de identificar un modelo que se
ajuste adecuadamente a los datos de una serie temporal: gráficos,
contrastes de raíz unitaria, ACF y PACF muestrales, estadísticos
descriptivos y contrastes de normalidad.
</p>

</div>
<div id="outline-container-orga0af7d0" class="outline-4">
<h4 id="orga0af7d0">Carga de algunas librerías de R</h4>
<div class="outline-text-4" id="text-orga0af7d0">
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">cargamos algunas librer&#237;as de R</span>
<span style="color: #D0372D;">library</span>(tfarima)      <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">librer&#237;a de Jos&#233; Luis Gallego para Time Series</span>
<span style="color: #D0372D;">library</span>(readr)        <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">para leer ficheros CSV</span>
<span style="color: #D0372D;">library</span>(ggplot2)      <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">para el scatterplot (alternaticamente library(tidyverse))</span>
<span style="color: #D0372D;">library</span>(ggfortify)    <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">para pintar series temporales</span>
<span style="color: #D0372D;">library</span>(jtools)       <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">para representaci&#243;n resultados estimaci&#243;n</span>
<span style="color: #D0372D;">library</span>(zoo)          <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">para generar objetos ts (time series)</span>
<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">y fijamos el tama&#241;o de las figuras que se generan en el notebook</span>
<span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 4, repr.plot.res = 200)
</pre>
</div>
</div>
</div>
<div id="outline-container-org78dc417" class="outline-2">
<h2 id="org78dc417"><span class="section-number-2">1.</span> ACF, PACF y densidad espectral de algunos modelos lineales (cont.)</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org4bf3573" class="outline-3">
<h3 id="org4bf3573"><span class="section-number-3">1.1.</span> Proceso autorregresivo ARMA(\(p,q\))</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Sea \(\;\boldsymbol{X}\;\) el proceso estocástico estacionario solución
de la ecuación en diferencias:
\[\boldsymbol{\phi}*\boldsymbol{X}=\boldsymbol{\theta}*\boldsymbol{U}\]
donde \(\;\boldsymbol{U}\sim WN(0,\sigma^2);\;\) el polinomio
<i>autorregresivo</i> \(\;\boldsymbol{\phi}\;\) tiene <span class="underline">grado \(p\)</span> con
\({\color{#008000}{\phi_{0}=1}}\) (y raíces fuera del círculo unidad), y
el polinomio <i>de media móvil</i> \(\;\boldsymbol{\theta}\;\) es <span class="underline">de grado
\(q\)</span> con \({\color{#008000}{\theta_{0}=1}};\;\) y donde
\(\boldsymbol{\phi}\) y \(\boldsymbol{\theta}\) no tienen raíces comunes.
</p>
<p>
Si \(\;\;\boldsymbol{\phi}(z)=1-\phi_1z-\cdots-\phi_p z^p\;\;\) y
\(\;\;\boldsymbol{\theta}(z)=1-\theta_1z-\cdots-\theta_q z^q,\;\;\)
entonces
</p>
\begin{align*}
  (1-\phi_1\mathsf{B}-\cdots-\phi_p\mathsf{B}^p)X_t = &
  (1-\theta_1\mathsf{B}-\cdots-\theta_q\mathsf{B}^q)U_t;
\end{align*}
<p>
y por tanto \[X_t= U_t + \sum_{j=1}^p\phi_j X_{t-j} +
\sum_{j=1}^q-\theta_j U_{t-j}.\]
</p>


<p>
Como las raíces de \(\boldsymbol{\phi}\) están fuera del círculo unidad,
es decir, como <i>el polinomio AR es ``invertible''</i>
\(\;(\boldsymbol{\phi}^{-\triangleright}=\boldsymbol{\phi}^{-1}\in\ell^1)\;\)
entonces \(\boldsymbol{X}\) tiene una representación como MA(\(\infty\)):
\[\boldsymbol{\phi}*\boldsymbol{X}=\boldsymbol{\theta}*\boldsymbol{U}
\quad\Rightarrow\quad
\boldsymbol{X}=\frac{\boldsymbol{\theta}}{\boldsymbol{\phi}}*\boldsymbol{U}
\quad\Rightarrow\quad X_t = U_t + \sum_{j=1}^\infty\psi_j U_{t-j};\]
donde
\(\;\boldsymbol{\psi}=\boldsymbol{\phi}^{-1}*\boldsymbol{\theta}=({\color{blue}1},\
\psi_1,\ \psi_2,\ \psi_3,\ldots)\;\) tiene grado \(\infty\).
</p>
<p>
Y como las raíces de \(\boldsymbol{\theta}\) están fuera del círculo
unidad, es decir, como <i>el polinomio MA es ``invertible''</i>
\(\;(\boldsymbol{\theta}^{-\triangleright}=\boldsymbol{\theta}^{-1}\in\ell^1)\;\)
entonces \(\boldsymbol{X}\) tiene una representación como AR(\(\infty\)):
\[\boldsymbol{\phi}*\boldsymbol{X}=\boldsymbol{\theta}*\boldsymbol{U}
\quad\Rightarrow\quad
\frac{\boldsymbol{\phi}}{\boldsymbol{\theta}}*\boldsymbol{X}=\boldsymbol{U}
\quad\Rightarrow\quad X_t = U_t + \sum_{j=1}^\infty-\varphi_j
X_{t-j};\] donde
\(\;\boldsymbol{\varphi}=\boldsymbol{\theta}^{-1}*\boldsymbol{\phi}=({\color{blue}1},\
\varphi_1,\ \varphi_2,\ \varphi_3,\ldots)\;\) tiene grado \(\infty\).
</p>
<p>
En un ARMA(\(p,q\)), por tener representación MA(\(\infty\)):
</p>
<p>
\(E(X_t)=0\) para todo \(t\in\mathbb{Z}\) y
</p>
<p>
\(\boldsymbol{\gamma} \;=\; \sigma^2
\frac{\boldsymbol{\theta}(z)}{\boldsymbol{\phi}(z)}*\frac{\boldsymbol{\theta}(z^{-1})}{\boldsymbol{\phi}(z^{-1})}
= \sigma^2 \boldsymbol{\psi}(z)*\boldsymbol{\psi}(z^{-1})\;\) donde \(\;\boldsymbol{\phi}=\frac{\boldsymbol{\theta}}{\boldsymbol{\phi}}\);
</p>
<p>
es decir, \(\;\gamma_k = \sigma^2 \sum\nolimits_{j=0}^\infty
\psi_{j+|k|}\psi_j;\quad k\in\mathbb{Z}\;\) (grado \(\infty\) y cogrado
\(-\infty\)).
</p>
<p>
\(\boldsymbol{\rho} \;=\; \frac{1}{\gamma_0}\boldsymbol{\gamma}\)
</p>
<p>
\(f(\omega) =
  \frac{\sigma^2}{2\pi}\frac{\boldsymbol{\theta}(e^{-i\omega})\cdot\boldsymbol{\theta}(e^{i\omega})}{\boldsymbol{\phi}(e^{-i\omega})\cdot\boldsymbol{\phi}(e^{i\omega})}
  \;=\; \frac{1}{2\pi}\sum\limits_{h=0}^\infty \gamma_h
  \cos(h\omega);\quad\) donde \(\omega\in[-\pi,\pi]\).
</p>

<p>
(suma infinita de cosenos)
</p>
<p>
En un ARMA(\(p,q\)), por tener representación AR(\(\infty\)):
</p>
<p>
su PACF, \(\;\boldsymbol{\pi},\;\) también es una secuencia con grado
\(\infty\) y cogrado \(-\infty\).
</p>
<p>
En la Lección 5 se demostró que para un proceso ARMA(\(p,q\))
\[\boldsymbol{\phi}(\mathsf{B})\gamma_k = 
\begin{cases}
  \sigma^2 \Big(\boldsymbol{\theta}(z)*\boldsymbol{\psi}(z^{-1})\Big)_k & \text{para } k\leq q \\
  0 & \text{para } k > q \quad \text{(como en un AR)}
\end{cases}\]
</p>
<p>
Así, en cuanto a la ACF \(\boldsymbol{\rho}\):
</p>
<ul class="org-ul">
<li>De \(\rho_1\) a \(\rho_q\) dependen de los \(q\) parámetros de
\(\boldsymbol{\theta}\) y los \(p\) parámetros de \(\boldsymbol{\phi}\)</li>
<li>Los \(p\) valores de \(\rho_q\) a \(\rho_{q-p+1}\) son los valores
iniciales para resolver la ecuación en diferencias
\(\boldsymbol{\phi}(\mathsf{B})\rho_k=0\;\) (con \(k\geq q)\)</li>
<li>Si \(q < p\) toda la secuencia \(\rho_j\) para \(j \geq 0\) decae
exponencialmente o sinusoidalmente según \(\boldsymbol{\phi}\) y los
valores iniciales \(\rho_q\) a \(\rho_{q-p+1}\)</li>
<li>Si \(q \geq p\) los primeros \(q-p+1\) valores iniciales \(\rho_0\) a
\(\rho_{q-p}\) siguen una pauta diferente</li>
</ul>

<p>
En cuanto a la PACF \(\boldsymbol{\pi}\):
</p>
<ul class="org-ul">
<li>Tiene grado \(\infty\) y cogrado \(-\infty\)</li>
<li>A partir de cierto retardo se comporta como la PACF de un MA(\(q\)),
es decir, decae exponencialmente o sinusoidalmente.</li>
</ul>
</div>
</div>
<div id="outline-container-orgaa17825" class="outline-3">
<h3 id="orgaa17825"><span class="section-number-3">1.2.</span> Proceso ARMA(\(1,1\))</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Sea \(\;(1-\phi z)*\boldsymbol{X}=(1-\theta z)*\boldsymbol{U}\;\) con
\(|\phi|<1\) y \(|\theta|<1\) y con \(\;\boldsymbol{U}\sim
WN(0,\sigma^2):\) 
</p>

<p>
\[X_t=\phi X_{t-1}-\theta U_{t-1} + U_t.\]
</p>

<ul class="org-ul">
<li>\(\boldsymbol{\gamma} \;=\; \sigma^2 \frac{(1-\theta z)*(1-\theta z^{-1})}{(1-\phi z)*(1-\phi z^{-1})}\; \text{ por tanto... }\)</li>

<li>\(\gamma_0 =
  \sigma^2\left(1+\frac{(\theta+\phi)^2}{1+\phi^2}\right);\quad
  \gamma_1 =
  \sigma^2\left(\phi+\theta+\frac{(\theta+\phi)^2\phi}{1+\phi^2}\right);\;
  \text{ y }\;\gamma_k =\phi\gamma_{k-1}\;\;\text{si } k>1\)</li>

<li>\(\boldsymbol{\rho} \;=\; \frac{1}{\gamma_0}\boldsymbol{\gamma}\)</li>

<li>\(f(\omega) \;=\;
  \;=\;
  \frac{\sigma^2}{2\pi}\frac{1+\theta^2-2\theta\cos(\omega)}{1+\phi^2-2\phi\cos(\omega)};\quad
  \omega\in[-\pi,\pi]\)</li>
</ul>

<ul class="org-ul">
<li>\(\boldsymbol{\pi} \text{ decae geométricamente con } \theta^k\)</li>
</ul>
</div>
<div id="outline-container-org4e2d748" class="outline-4">
<h4 id="org4e2d748"><span class="section-number-4">1.2.1.</span> ARMA(1,1) \(\phi_1=0.7\) y \(\theta_1=-0.8\)</h4>
<div class="outline-text-4" id="text-1-2-1">
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 2, repr.plot.res = 200)
arma11R <span style="color: #D0372D;">&lt;-</span> um(ar = <span style="color: #008000;">"(1 - 0.7B)"</span>, ma = <span style="color: #008000;">"(1 + 0.8B)"</span>)
display(list(arma11R), lag.max = 20, byrow = <span style="color: #6434A3;">TRUE</span>)
</pre>
</div>

<p>
\[(1 - 0.7\mathsf{B}){X_t}=(1 + 0.8\mathsf{B}){U_t};\quad \phi>0;\;\theta<0\]
</p>


<div id="org0263d21" class="figure">
<p><img src="./img/lecc07/ACF-arma11R.png" alt="ACF-arma11R.png" width="900px" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 5, repr.plot.res = 200)
ide(sim(arma11R, n = 400), lag.max = 20, graphs = c(<span style="color: #008000;">"plot"</span>, <span style="color: #008000;">"acf"</span>, <span style="color: #008000;">"pacf"</span>, <span style="color: #008000;">"pgram"</span>))
</pre>
</div>


<div id="org5c154ab" class="figure">
<p><img src="./img/lecc06/Sim-arma11R.png" alt="Sim-arma11R.png" width="900px" />
</p>
</div>
</div>
</div>
<div id="outline-container-org4159ad3" class="outline-4">
<h4 id="org4159ad3"><span class="section-number-4">1.2.2.</span> ARMA(1,1) \(\phi_1=-0.7\) y \(\theta_1=0.8\)</h4>
<div class="outline-text-4" id="text-1-2-2">
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 2, repr.plot.res = 200)
arma11A <span style="color: #D0372D;">&lt;-</span> um(ar = <span style="color: #008000;">"(1 + 0.7B)"</span>, ma = <span style="color: #008000;">"(1 - 0.8B)"</span>)
display(list(arma11A), lag.max = 20, byrow = <span style="color: #6434A3;">TRUE</span>)
</pre>
</div>

<p>
\[(1 + 0.7\mathsf{B}){X_t}=(1 - 0.8\mathsf{B}){U_t};\quad \phi<0;\;\theta>0\]
</p>


<div id="org103c33e" class="figure">
<p><img src="./img/lecc07/ACF-arma11A.png" alt="ACF-arma11A.png" width="900px" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 5, repr.plot.res = 200)
ide(sim(arma11A, n = 400), lag.max = 20, graphs = c(<span style="color: #008000;">"plot"</span>, <span style="color: #008000;">"acf"</span>, <span style="color: #008000;">"pacf"</span>, <span style="color: #008000;">"pgram"</span>))
</pre>
</div>


<div id="orgb2bfb66" class="figure">
<p><img src="./img/lecc06/Sim-arma11A.png" alt="Sim-arma11A.png" width="900px" />
</p>
</div>
</div>
</div>
<div id="outline-container-org6765042" class="outline-4">
<h4 id="org6765042"><span class="section-number-4">1.2.3.</span> ARMA(1,1) \(\phi_1=0.4\) y \(\theta_1=0.8\)</h4>
<div class="outline-text-4" id="text-1-2-3">
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 2, repr.plot.res = 200)
arma11NVA  <span style="color: #D0372D;">&lt;-</span> um(ar = <span style="color: #008000;">"(1 - 0.4B)"</span>, ma = <span style="color: #008000;">"(1 - 0.8B)"</span>)
display(list(arma11NVA), lag.max = 20, byrow = <span style="color: #6434A3;">TRUE</span>)
</pre>
</div>

<p>
\[(1 - 0.4\mathsf{B}){X_t}=(1 - 0.8\mathsf{B}){U_t};\quad \phi>0;\;\theta>0\]
</p>


<div id="org526518f" class="figure">
<p><img src="./img/lecc07/ACF-arma11NVA.png" alt="ACF-arma11NVA.png" />
</p>
</div>


<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 5, repr.plot.res = 200)
ide(sim(arma11NVA, n = 400), lag.max = 20, graphs = c(<span style="color: #008000;">"plot"</span>, <span style="color: #008000;">"acf"</span>, <span style="color: #008000;">"pacf"</span>, <span style="color: #008000;">"pgram"</span>))
</pre>
</div>


<div id="orga76b65d" class="figure">
<p><img src="./img/lecc06/Sim-arma11NVA.png" alt="Sim-arma11NVA.png" width="900px" />
</p>
</div>
</div>
</div>
<div id="outline-container-orgf5ca3fd" class="outline-4">
<h4 id="orgf5ca3fd"><span class="section-number-4">1.2.4.</span> ARMA(1,1) \(\phi_1=-0.8\) y \(\theta_1=-0.4\)</h4>
<div class="outline-text-4" id="text-1-2-4">
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 2, repr.plot.res = 200)
arma11RNV <span style="color: #D0372D;">&lt;-</span> um(ar = <span style="color: #008000;">"(1 + 0.8B)"</span>, ma = <span style="color: #008000;">"(1 + 0.4B)"</span>)
display(list(arma11RNV), lag.max = 20, byrow = <span style="color: #6434A3;">TRUE</span>)
</pre>
</div>

<p>
\[(1 + 0.8\mathsf{B}){X_t}=(1 + 0.4\mathsf{B}){U_t};\quad \phi<0;\;\theta<0\]
</p>


<div id="orgf18667c" class="figure">
<p><img src="./img/lecc07/ACF-arma11RNV.png" alt="ACF-arma11RNV.png" width="900px" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 5, repr.plot.res = 200)
ide(sim(arma11RNV, n = 400), lag.max = 20, graphs = c(<span style="color: #008000;">"plot"</span>, <span style="color: #008000;">"acf"</span>, <span style="color: #008000;">"pacf"</span>, <span style="color: #008000;">"pgram"</span>))
</pre>
</div>


<div id="orgef0b702" class="figure">
<p><img src="./img/lecc06/Sim-arma11RNV.png" alt="Sim-arma11RNV.png" width="900px" />
</p>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-orgcc0fb02" class="outline-2">
<h2 id="orgcc0fb02"><span class="section-number-2">2.</span> La especificación del modelo se escoge según las características de los datos.</h2>
<div class="outline-text-2" id="text-2">
<p>
¿Es la serie 
</p>
<ul class="org-ul">
<li>"<b><i>estacionaria en media</i></b>"?
<ul class="org-ul">
<li>(y si lo es, ¿cuál es su media?)</li>
<li>(y si no lo es, ¿cómo cambia o evoluciona su media?)</li>
</ul></li>
<li>"<b><i>estacionaria en varianza</i></b>"? (<i>homocedástica</i>)
<ul class="org-ul">
<li>(y si lo es, ¿cuál es su varianza?)</li>
<li>(y si es <i>heterocedástica</i>, ¿cómo cambia o evoluciona su varianza?)</li>
</ul></li>
</ul>

<p>
¿Están sus valores correlados con su historia pasada (autocorrelados)?
</p>

<p>
¿Qué correlación tienen los datos con los datos \(k\) periodos atrás una
vez descontado el efecto de los datos intermedios?
</p>
<p>
Veamos algunas herramientas estadísticas para poder desvelar estas
características.
</p>
</div>
</div>
<div id="outline-container-org53f0513" class="outline-2">
<h2 id="org53f0513"><span class="section-number-2">3.</span> Herramientas para desvelar propiedades de una serie temporal</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-orgd160f15" class="outline-3">
<h3 id="orgd160f15"><span class="section-number-3">3.1.</span> Análisis gráfico</h3>
<div class="outline-text-3" id="text-3-1">
</div>
<div id="outline-container-orgcd7d67d" class="outline-4">
<h4 id="orgcd7d67d"><span class="section-number-4">3.1.1.</span> Gráfico de la serie temporal</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
Representa sus valores en el eje vertical (\(y\)) frente a una escala
temporal en el horizontal (\(x\)). Es útil para detectar visualmente:
</p>
<ul class="org-ul">
<li>tendencias y/o estacionalidad</li>
<li>cambios de variabilidad</li>
<li>valores atípicos (<i>outliers</i>)
<ul class="org-ul">
<li>el 95% aprox. de una muestra de valores generados por una
distribución normal debería estar comprendido entre
\(\mu\pm2\sigma\)</li>
<li><p>
la probabilidad de que una variable normal genere un valor fuera
de las bandas de \(\mu\pm3\sigma\) es \(0.0023\)
</p>

<p>
(<a href="./img/lecc05/IBEX35.png">véase gráfico IBEX 35</a>)
</p></li>
</ul></li>
</ul>

<p>
Es importante escalar y rotular adecuadamente los ejes y asegurar la
comparabilidad entre series y gráficos distintos (si los hubiere).
</p>
</div>
</div>
<div id="outline-container-orgc6d17df" class="outline-4">
<h4 id="orgc6d17df"><span class="section-number-4">3.1.2.</span> Gráfico rango-media</h4>
<div class="outline-text-4" id="text-3-1-2">
<p>
Cambios de variabilidad de una serie pueden evidenciarse en su gráfico
temporal.
</p>

<p>
Pero también suelen verse bien en un gráfico rango-media, donde se
representa:
</p>

<ul class="org-ul">
<li><b>en eje \(x\):</b> nivel de la serie (normalmente la media de submuestras no solapadas).</li>

<li><b>en eje \(y\):</b> dispersión de la serie (normalmente el rango de dichas submuestras).</li>
</ul>

<p>
Si los puntos se sitúan alrededor de una recta de pendiente positiva, tomar logaritmos.
</p>
<p>
Veamos el gráfico de la serie de pasajeros de líneas aéreas junto a su
gráfico de rango media:
</p>

<div class="org-src-container">
<pre class="src src-jupyter-R">Z <span style="color: #D0372D;">&lt;-</span> AirPassengers
ide(Z, graphs = c(<span style="color: #008000;">"plot"</span>, <span style="color: #008000;">"rm"</span>), main=<span style="color: #008000;">"Pasajeros de l&#237;neas (a&#233;reas en miles) y gr&#225;fico rango-media"</span>)
</pre>
</div>


<div id="org71f5387" class="figure">
<p><img src="./img/lecc07/rango-mediaAirPass.png" alt="rango-mediaAirPass.png" width="900px" />
</p>
</div>

<p>
El gráfico de rango media a veces se acompaña de una regresión de la
dispersión sobre los niveles para medir la relación nivel-dispersión.
</p>
</div>
</div>
</div>
<div id="outline-container-org201a631" class="outline-3">
<h3 id="org201a631"><span class="section-number-3">3.2.</span> Determinación del orden de integración</h3>
<div class="outline-text-3" id="text-3-2">
<p>
El <i>orden de integración</i> es el número mínimo de diferencias
necesarias para lograr la estacionariedad en media.
</p>

<p>
Decidir adecuadamente el orden de integración es crucial en el
análisis de series temporales.
</p>

<p>
Las herramientas utilizadas para tomar la decisión son 
</p>
<ul class="org-ul">
<li>el análisis gráfico</li>
<li>los contrastes formales</li>
</ul>
</div>
<div id="outline-container-org3dcfc2b" class="outline-4">
<h4 id="org3dcfc2b"><span class="section-number-4">3.2.1.</span> Análisis gráfico</h4>
<div class="outline-text-4" id="text-3-2-1">
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height = 8, repr.plot.res = 200)
PoblacionAustralia_ts = as.ts( read.zoo(<span style="color: #008000;">'datos/PoblacionAustralia.csv'</span>, 
                                        header=<span style="color: #6434A3;">TRUE</span>,
                                        index.column = 1, 
                                        sep=<span style="color: #008000;">","</span>, 
                                        FUN = as.yearmon))
ide(PoblacionAustralia_ts,
    graphs = c(<span style="color: #008000;">"plot"</span>),
    transf = list(list(bc = F), list(bc = F, d = 1), list(bc = F, d = 2)),
    main=<span style="color: #008000;">"Poblaci&#243;n australiana, primera diferencia y segunda diferencia"</span> )
</pre>
</div>


<div id="org7cb82e9" class="figure">
<p><img src="./img/lecc07/diferenciasPoblacion.png" alt="diferenciasPoblacion.png" width="900px" />
</p>
</div>



<p>
La serie de población \(\boldsymbol{y}\) tiene una clara tendencia
creciente (primer gráfico), que desaparece al tomar una diferencia
ordinaria, \[\nabla\boldsymbol{y}=(1-\mathsf{B})*\boldsymbol{y}\]
(segundo gráfico). Bastar con tomar una primera diferencia de la serie
de población para obtener una nueva serie que se asemeja a la
realización de un proceso estacionario.
</p>

<p>
No obstante, ¿qué pasa si tomamos una segunda diferencia ordinaria?
\[\nabla\nabla\boldsymbol{y}=\nabla^2\boldsymbol{y}=(1-\mathsf{B})^2*\boldsymbol{y}\]
(segundo gráfico). Pues que la serie obtenida también es estacionaria,
pero ojo, es un grave error tomar más diferencias de las necesarias al
modelizar los datos. Se debe tomar el mínimo número de
transformaciones que arrojen una serie ``estacionaria'' (recuerde que
decir que una serie temporal es <i>estacionaria</i> es un abuso del
lenguaje).
</p>

<p>
Si se toman más diferencias de las necesarias se obtiene un proceso
<i>no invertible</i> (raíces unitarias en la parte MA que imposibilitan que
el proceso tenga una representación como AR(\(\infty\)) causal), lo cual
conduce a problemas de identificación y estimación.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height =  10, repr.plot.res = 200)
ide(Z,
    graphs = c(<span style="color: #008000;">"plot"</span>),
    transf = list(list(bc=T), list(bc=T, d=1), list(bc=T, D=1), list(bc=T, D=1, d=1)),
    main = <span style="color: #008000;">"Log pasajeros a&#233;reos, diferencia ordinaria, diferencia estacional y composici&#243;n de ambas diferencias"</span> )
</pre>
</div>


<div id="orgd6362bc" class="figure">
<p><img src="./img/lecc07/diferenciasPasajeros.png" alt="diferenciasPasajeros.png" width="900px" />
</p>
</div>

<p>
Como ya vimos, la serie pasajeros en logaritmos tiene tendencia y
estacionalidad muy evidentes. No basta con tomar solo una diferencia
ordinaria \[\nabla\boldsymbol{y}=(1-\mathsf{B})*\boldsymbol{y};\] pues
el resultado muestra una pauta estacional. Ni tampoco basta con tomar
solo una diferencia estacional
\[\nabla_{12}(\boldsymbol{y})=(1-\mathsf{B^{12}})*\boldsymbol{y};\] pues
resulta una serie que ``deambula'', i.e., que no es <i>``estacionaria''</i>
en media.
</p>

<p>
Tomar una diferencia ordinaria y otra estacional
\[\nabla\nabla_{12}(\boldsymbol{y})=(1-\mathsf{B})*(1-\mathsf{B^{12}})*\boldsymbol{y}\]
arroja una serie que sí parece ser <i>``estacionaria''</i>.
</p>


<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">options</span>(repr.plot.width = 12, repr.plot.height =  8, repr.plot.res = 200)
TemperaturaRetiro_ts=ts(read.csv(<span style="color: #008000;">"datos/Retiro.txt"</span>),start=c(1985, 1), end=c(2015,9), frequency=12)
ide(TemperaturaRetiro_ts,
    graphs = c(<span style="color: #008000;">"plot"</span>),
    transf = list(list(), list(D = 1)),
    main=<span style="color: #008000;">"Temperatura media en el Retiro y diferencia estacional"</span> )
</pre>
</div>


<div id="org33730fc" class="figure">
<p><img src="./img/lecc07/diferenciasTemperaturasRetiro.png" alt="diferenciasTemperaturasRetiro.png" width="900px" />
</p>
</div>


<p>
En el caso de la serie de temperaturas en el Parque del Retiro, parece
que es suficiente con tomar solo una diferencia estacional.
</p>
</div>
</div>
<div id="outline-container-orgb6d73d7" class="outline-4">
<h4 id="orgb6d73d7"><span class="section-number-4">3.2.2.</span> Contrastes formales sobre el orden de integración: DF, ADF y KPSS</h4>
<div class="outline-text-4" id="text-3-2-2">
</div>
<ol class="org-ol">
<li><a id="orga90572b"></a>Test de Dickey-Fuller (DF)<br />
<div class="outline-text-5" id="text-3-2-2-1">
<dl class="org-dl">
<dt>\(H_0\)</dt><dd>la serie es \(I(1)\)</dd>
<dt>\(H_1\)</dt><dd>la serie es \(I(0)\).</dd>
</dl>

<p>
Sea el siguiente modelo donde \(\phi\) es un parámetro autorregresivo y
\(U_{t}\) es ruido blanco \[Y_{t}=\phi Y_{t-1}+U_{t},\]
</p>

<p>
Habrá una raíz unitaria (será no-estacionario) si \(\phi =1.\;\) Restando
\(Y_{t-1}\) a ambos lados
</p>

<p>
\[\nabla Y_{t}\;=\;(\phi -1)Y_{t-1}+U_{t}\;=\;\delta Y_{t-1}+U_{t}\]
</p>

<p>
donde \(\delta=\phi -1\) y, por tanto, la \(H_0\) se reduce a \(\delta=0\).
</p>

<p>
Pasos del contraste:
</p>
<ul class="org-ul">
<li>se estima el último modelo por MCO</li>
<li>se calcula el ratio \(t\) de significación de \(\delta\)</li>
<li>se compara dicho ratio con la distribución específica del contraste
\(DF\) (pues bajo la nula, el ratio \(t\) no se distribuye de la forma
habitual).</li>
</ul>
</div>
</li>
<li><a id="orgdb54c08"></a>Test de Dickey-Fuller aumentado (ADF)<br />
<div class="outline-text-5" id="text-3-2-2-2">
<p>
Una variante habitual del test DF es el test de Dickey-Fuller
aumentado (ADF), que consiste en estimar por MCO el modelo: \[\nabla
Y_t = c + \delta Y_{t-1} + \pi_1 \nabla Y_{t-1} + \pi_2 \nabla
Y_{t-2} + \cdots + \pi_p \nabla Y_{t-p} + U_t\] que añade \(p\) retardos
del regresando como regresores para permitir autocorrelación. Por lo
demás, el test se calcula de la forma habitual (comparando de ratio
\(t\) de \(\widehat{\delta}\) con las tablas del test ADF).
</p>

<p>
Otra variante consiste en incluir una tendencia temporal determinista:
\[\nabla Y_t = \underbrace{c + \beta t} + \delta Y_{t-1} + \pi_1 \nabla Y_{t-1} + \pi_2 \nabla Y_{t-2} + \cdots + \pi_p \nabla Y_{t-p} + U_t\]
</p>
</div>
</li>
<li><a id="orge523ec1"></a>Test Kwiatkowski–Phillips–Schmidt–Shin (KPSS)<br />
<div class="outline-text-5" id="text-3-2-2-3">
<p>
El contraste KPSS es un contraste alternativo (y complementario) al test DF/ADF
</p>

<p>
Las hipótesis del test KPSS están invertidas respecto a las del Test DF
</p>
<dl class="org-dl">
<dt>\(H_0\)</dt><dd>la serie es \(I(0)\).</dd>
<dt>\(H_1\)</dt><dd>la serie es \(I(1)\) o estacionaria en torno a una tendencia determinista</dd>
</dl>

<p>
<b>DF/ADF y KPSS se complementan.</b> Si la series es:
</p>
<ul class="org-ul">
<li><i>estacionaria</i>: el test DF/ADF debería rechazar su \(H_0:\) la serie es \(I(1)\)</li>
<li><i>NO estacionaria</i>: el test KPSS debería rechazar su \(H_0:\) la serie es \(I(0)\)</li>
</ul>

<p>
Estos test son poco potentes y son frágiles ante incumplimientos
(heterocedasticidad o no-normalidad); por ello debemos complementarlos
con el análisis gráfico.
</p>
</div>
</li>
</ol>
</div>
</div>
<div id="outline-container-org1385020" class="outline-3">
<h3 id="org1385020"><span class="section-number-3">3.3.</span> ACF muestral</h3>
<div class="outline-text-3" id="text-3-3">
<p>
La <i>k</i>-ésima autocorrelación muestral simple (\(\widehat{\rho_k}\)) se
define como:
\[\widehat{\rho_k}=\frac{\widehat{\rho_k}}{\widehat{\rho_0}};\qquad
\widehat{\rho_k}=\frac{1}{n}\sum_{t=k+1}^n
\widetilde{X_t}\widetilde{X_{t-k}},\quad\text{para }\;k=1,2,\ldots\]
donde \(\widetilde{X_t}=X_t-\bar{X}\).
</p>

<p>
Para valorar la significatividad individual de estas autocorrelaciones
puede usarse el error estándar asintótico:
\(s.e(\widehat{\rho_k})=1/\sqrt{n}\).
</p>

<p>
Para contrastar la \(H_0:\) <i>conjuntamente los \(k\) primeros retardos son
no significativos</i> (es decir, para contrastar si el proceso es <i>ruido
blanco</i>) se emplea el test de Ljung-Box \[Q =
n\left(n+2\right)\sum_{k=1}^h\frac{\hat{\rho}^2_k}{n-k}\]
(usaremos el test de Ljung-Box para evaluar los modelos).
</p>
</div>
</div>
<div id="outline-container-orgcbcbec6" class="outline-3">
<h3 id="orgcbcbec6"><span class="section-number-3">3.4.</span> PACF muestral</h3>
<div class="outline-text-3" id="text-3-4">
<p>
La <i>k</i>-ésima autocorrelación muestral \(\widehat{\pi_k}\) se puede
estimar mediante el algoritmo Levinson-Durbin sustituyendo las
autocorrelaciones teóricas por las muestrales.
</p>

<p>
O bien, calculando el <i>k</i>-ésimo coeficiente MCO de una autorregresión
de orden \(k\) \[\widetilde{X}_t =
\widehat{\phi_{k1}}\widetilde{X}_{t-1} +
\widehat{\phi_{k2}}\widetilde{X}_{t-2} + \cdots +
\widehat{\phi_{kk}}\widetilde{X}_{t-k} + U_t;\qquad k = 1, 2,\ldots\]
donde \(\widetilde{X}_t=X_t-\bar{X}\;\) y donde
\(\;\widehat{\pi_k}=\widehat{\phi_{kk}}\)
</p>
</div>
</div>
<div id="outline-container-org690e710" class="outline-3">
<h3 id="org690e710"><span class="section-number-3">3.5.</span> Otras herramientas estadísticas&#xa0;&#xa0;&#xa0;<span class="tag"><span class="C_moHacerConR">CómoHacerConR</span></span></h3>
<div class="outline-text-3" id="text-3-5">
</div>
<div id="outline-container-org8af0868" class="outline-4">
<h4 id="org8af0868"><span class="section-number-4">3.5.1.</span> Estadísticos descriptivos</h4>
<div class="outline-text-4" id="text-3-5-1">
<ul class="org-ul">
<li>el nivel de la serie (media, mediana),</li>
<li>valores extremos (máximo y mínimo). A veces son outliers o errores de registro</li>
<li>dispersión de la variable (desviación típica, coeficiente de variación, rango, rango interpercentiles, rango intercuartílico)</li>
<li>otros momentos (asimetría, exceso de curtosis)</li>
</ul>

<p>
También es frecuente contrastar si la media es significativa ( \(H_0: \mu = 0\))
\[\frac{\widehat{\mu}}{\widehat{dt(\widehat{\mu})}}\underset{H_0}{\sim}t_{n-1};\qquad
\widehat{dt(\widehat{\mu})}=\frac{\widehat{\sigma}}{\sqrt{n}}.\]
</p>

<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">library</span>(pastecs)      <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">resumen estad&#237;sticos descriptivos</span>
<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">https://cran.r-project.org/web/packages/pastecs/index.html (stat.desc)</span>
<span style="color: #D0372D;">library</span>(knitr)        <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">presentaci&#243;n de tabla resumen</span>
<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">https://cran.r-project.org/web/packages/knitr/index.html (kable)</span>
<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">https://bookdown.org/yihui/rmarkdown-cookbook/kable.html</span>

<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">estad&#237;sticos principales y test de normalidad</span>
kable(stat.desc(Z, basic=<span style="color: #6434A3;">FALSE</span>, norm=<span style="color: #6434A3;">TRUE</span>), <span style="color: #008000;">'rst'</span>)
</pre>
</div>

<pre class="example" id="org2eafba0">


============  =============
\                         x
============  =============
median          265.5000000
mean            280.2986111
SE.mean           9.9971931
CI.mean.0.95     19.7613736
var           14391.9172009
std.dev         119.9663169
coef.var          0.4279947
skewness          0.5710676
skew.2SE          1.4132515
kurtosis         -0.4298441
kurt.2SE         -0.5353818
normtest.W        0.9519577
normtest.p        0.0000683
============  =============
</pre>
</div>
</div>
<div id="outline-container-orgece7246" class="outline-4">
<h4 id="orgece7246"><span class="section-number-4">3.5.2.</span> Contraste de normalidad Jarque-Bera</h4>
<div class="outline-text-4" id="text-3-5-2">
<p>
<a href="https://en.wikipedia.org/wiki/Jarque%E2%80%93Bera_test">Jarque-Bera test (Wikipedia)</a>
</p>

<dl class="org-dl">
<dt>Si los datos son mayores que cero</dt><dd>a menudo la transformación
logarítmica ayuda a conseguir normalidad</dd>

<dt>Si hay valores atípicos</dt><dd>el mejor tratamiento es <i>intervenirlos</i>.</dd>
</dl>


<p>
Podemos calcularlo con la librería <a href="https://cran.r-project.org/web/packages/moments/index.html">momments</a>:
</p>
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #8D8D84;">#</span><span style="color: #8D8D84; font-style: italic;">install.packages("moments")</span>
<span style="color: #D0372D;">library</span>(moments)
<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Perform the Jarque-Bera test</span>
jb_test <span style="color: #D0372D;">&lt;-</span> jarque.test(as.numeric(Z))
<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Print the test result</span>
print(jb_test)
</pre>
</div>

<pre class="example">

	Jarque-Bera Normality Test

data:  as.numeric(Z)
JB = 8.9225, p-value = 0.01155
alternative hypothesis: greater

</pre>


<pre class="example">

	Jarque-Bera Normality Test

data:  as.numeric(Z)
JB = 8.9225, p-value = 0.01155
alternative hypothesis: greater

</pre>


<p>
Otra librería alternativa para calcularlo: <a href="https://cran.r-project.org/web/packages/tseries/index.html">tseries</a>
</p>
<div class="org-src-container">
<pre class="src src-jupyter-R"><span style="color: #D0372D;">library</span>(tseries)
<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Perform the Jarque-Bera test</span>
jb_test <span style="color: #D0372D;">&lt;-</span> jarque.bera.test(Z)
<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Print the test result</span>
print(jb_test)
</pre>
</div>

<pre class="example" id="org5b2e4a5">
Registered S3 method overwritten by 'quantmod':
  method            from
  as.zoo.data.frame zoo 

	Jarque Bera Test

data:  Z
X-squared = 8.9225, df = 2, p-value = 0.01155
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Marcos Bujosa</p>
<p class="date">Created: 2024-09-28 sáb 17:59</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
